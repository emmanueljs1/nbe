<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang xml:lang>
<head>
  <meta charset="utf-8" />
  <meta name="generator" content="pandoc" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
  <title>SystemT</title>
  <style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
width: 0.8em;
margin: 0 0.8em 0.2em -1.6em;
vertical-align: middle;
}
.display.math{display: block; text-align: center; margin: 0.5rem auto;}
</style>
  <style type="text/css">
.Agda .Comment { color: #B22222 }
.Agda .Background {}
.Agda .Markup { color: #000000 }
.Agda .Keyword { color: #CD6600 }
.Agda .String { color: #B22222 }
.Agda .Number { color: #A020F0 }
.Agda .Symbol { color: #404040 }
.Agda .PrimitiveType { color: #0000CD }
.Agda .Pragma { color: black }
.Agda .Operator {}
.Agda .Hole { background: #B4EEB4 }

.Agda .Bound { color: black }
.Agda .Generalizable { color: black }
.Agda .InductiveConstructor { color: #008B00 }
.Agda .CoinductiveConstructor { color: #8B7500 }
.Agda .Datatype { color: #0000CD }
.Agda .Field { color: #EE1289 }
.Agda .Function { color: #0000CD }
.Agda .Module { color: #A020F0 }
.Agda .Postulate { color: #0000CD }
.Agda .Primitive { color: #0000CD }
.Agda .Record { color: #0000CD }

.Agda .DottedPattern {}
.Agda .UnsolvedMeta { color: black; background: yellow }
.Agda .UnsolvedConstraint { color: black; background: yellow }
.Agda .TerminationProblem { color: black; background: #FFA07A }
.Agda .IncompletePattern { color: black; background: #F5DEB3 }
.Agda .Error { color: red; text-decoration: underline }
.Agda .TypeChecks { color: black; background: #ADD8E6 }
.Agda .Deadcode { color: black; background: #808080 }
.Agda .ShadowingInTelescope { color: black; background: #808080 }

.Agda a { text-decoration: none }
.Agda a[href]:hover { background-color: #B4EEB4 }
.Agda [href].hover-highlight { background-color: #B4EEB4; }
</style>
  <!--[if lt IE 9]>
    <script src="//cdnjs.cloudflare.com/ajax/libs/html5shiv/3.7.3/html5shiv-printshiv.min.js"></script>
  <![endif]-->
</head>
<body>
<h1 id="system-t">System T</h1>
We start off by defining the language that we will use to showcase
normalization by evaluation, System T, as is done in Section 2.1.
<pre class="Agda"><a id="154" class="Keyword">import</a> <a id="161" href="Relation.Binary.PropositionalEquality.html" class="Module">Relation.Binary.PropositionalEquality</a> <a id="199" class="Symbol">as</a> <a id="202" class="Module">Eq</a>
<a id="205" class="Keyword">open</a> <a id="210" class="Keyword">import</a> <a id="217" href="Relation.Nullary.html" class="Module">Relation.Nullary</a> <a id="234" class="Keyword">using</a> <a id="240" class="Symbol">(</a><a id="241" href="Relation.Nullary.html#1511" class="Record">Dec</a><a id="244" class="Symbol">;</a> <a id="246" href="Relation.Nullary.html#1648" class="InductiveConstructor">yes</a><a id="249" class="Symbol">;</a> <a id="251" href="Relation.Nullary.html#1685" class="InductiveConstructor">no</a><a id="253" class="Symbol">)</a>
<a id="255" class="Keyword">open</a> <a id="260" href="Relation.Binary.PropositionalEquality.html" class="Module">Eq</a> <a id="263" class="Keyword">using</a> <a id="269" class="Symbol">(</a><a id="270" href="Agda.Builtin.Equality.html#151" class="Datatype Operator">_≡_</a><a id="273" class="Symbol">;</a> <a id="275" href="Agda.Builtin.Equality.html#208" class="InductiveConstructor">refl</a><a id="279" class="Symbol">)</a>

<a id="282" class="Keyword">module</a> <a id="289" href="SystemT.html" class="Module">SystemT</a> <a id="297" class="Keyword">where</a>
</pre>
<p>It has natural numbers, higher-order functions, and primitive
recursion. We will define it with intrinsic typing, and use a de Brujin
index representation for variables.</p>
We start off with the types of tha language: naturals and functions.
<pre class="Agda"><a id="556" class="Keyword">data</a> <a id="Type"></a><a id="561" href="SystemT.html#561" class="Datatype">Type</a> <a id="566" class="Symbol">:</a> <a id="568" href="Agda.Primitive.html#326" class="Primitive">Set</a> <a id="572" class="Keyword">where</a>
  <a id="Type.nat"></a><a id="580" href="SystemT.html#580" class="InductiveConstructor">nat</a> <a id="584" class="Symbol">:</a> <a id="586" href="SystemT.html#561" class="Datatype">Type</a>
  <a id="Type._⇒_"></a><a id="593" href="SystemT.html#593" class="InductiveConstructor Operator">_⇒_</a> <a id="597" class="Symbol">:</a> <a id="599" class="Symbol">∀</a> <a id="601" class="Symbol">(</a><a id="602" href="SystemT.html#602" class="Bound">S</a> <a id="604" href="SystemT.html#604" class="Bound">T</a> <a id="606" class="Symbol">:</a> <a id="608" href="SystemT.html#561" class="Datatype">Type</a><a id="612" class="Symbol">)</a> <a id="614" class="Symbol">→</a> <a id="616" href="SystemT.html#561" class="Datatype">Type</a>

<a id="622" class="Keyword">infixr</a> <a id="629" class="Number">7</a> <a id="631" href="SystemT.html#593" class="InductiveConstructor Operator">_⇒_</a>

<a id="_≟Tp_"></a><a id="636" href="SystemT.html#636" class="Function Operator">_≟Tp_</a> <a id="642" class="Symbol">:</a> <a id="644" class="Symbol">∀</a> <a id="646" class="Symbol">(</a><a id="647" href="SystemT.html#647" class="Bound">S</a> <a id="649" href="SystemT.html#649" class="Bound">T</a> <a id="651" class="Symbol">:</a> <a id="653" href="SystemT.html#561" class="Datatype">Type</a><a id="657" class="Symbol">)</a> <a id="659" class="Symbol">→</a> <a id="661" href="Relation.Nullary.html#1511" class="Record">Dec</a> <a id="665" class="Symbol">(</a><a id="666" href="SystemT.html#647" class="Bound">S</a> <a id="668" href="Agda.Builtin.Equality.html#151" class="Datatype Operator">≡</a> <a id="670" href="SystemT.html#649" class="Bound">T</a><a id="671" class="Symbol">)</a>
<a id="673" href="SystemT.html#580" class="InductiveConstructor">nat</a> <a id="677" href="SystemT.html#636" class="Function Operator">≟Tp</a> <a id="681" href="SystemT.html#580" class="InductiveConstructor">nat</a> <a id="685" class="Symbol">=</a> <a id="687" href="Relation.Nullary.html#1648" class="InductiveConstructor">yes</a> <a id="691" href="Agda.Builtin.Equality.html#208" class="InductiveConstructor">refl</a>
<a id="696" href="SystemT.html#580" class="InductiveConstructor">nat</a> <a id="700" href="SystemT.html#636" class="Function Operator">≟Tp</a> <a id="704" class="Symbol">(</a><a id="705" href="SystemT.html#705" class="Bound">S</a> <a id="707" href="SystemT.html#593" class="InductiveConstructor Operator">⇒</a> <a id="709" href="SystemT.html#709" class="Bound">T</a><a id="710" class="Symbol">)</a> <a id="712" class="Symbol">=</a> <a id="714" href="Relation.Nullary.html#1685" class="InductiveConstructor">no</a> <a id="717" class="Symbol">λ()</a>
<a id="721" class="Symbol">(</a><a id="722" href="SystemT.html#722" class="Bound">S₁</a> <a id="725" href="SystemT.html#593" class="InductiveConstructor Operator">⇒</a> <a id="727" href="SystemT.html#727" class="Bound">T₁</a><a id="729" class="Symbol">)</a> <a id="731" href="SystemT.html#636" class="Function Operator">≟Tp</a> <a id="735" href="SystemT.html#580" class="InductiveConstructor">nat</a> <a id="739" class="Symbol">=</a> <a id="741" href="Relation.Nullary.html#1685" class="InductiveConstructor">no</a> <a id="744" class="Symbol">λ()</a>
<a id="748" class="Symbol">(</a><a id="749" href="SystemT.html#749" class="Bound">S₁</a> <a id="752" href="SystemT.html#593" class="InductiveConstructor Operator">⇒</a> <a id="754" href="SystemT.html#754" class="Bound">T₁</a><a id="756" class="Symbol">)</a> <a id="758" href="SystemT.html#636" class="Function Operator">≟Tp</a> <a id="762" class="Symbol">(</a><a id="763" href="SystemT.html#763" class="Bound">S₂</a> <a id="766" href="SystemT.html#593" class="InductiveConstructor Operator">⇒</a> <a id="768" href="SystemT.html#768" class="Bound">T₂</a><a id="770" class="Symbol">)</a> <a id="772" class="Keyword">with</a> <a id="777" href="SystemT.html#749" class="Bound">S₁</a> <a id="780" href="SystemT.html#636" class="Function Operator">≟Tp</a> <a id="784" href="SystemT.html#763" class="Bound">S₂</a> <a id="787" class="Symbol">|</a> <a id="789" href="SystemT.html#754" class="Bound">T₁</a> <a id="792" href="SystemT.html#636" class="Function Operator">≟Tp</a> <a id="796" href="SystemT.html#768" class="Bound">T₂</a>
<a id="799" class="Symbol">...</a> <a id="803" class="Symbol">|</a> <a id="805" href="Relation.Nullary.html#1685" class="InductiveConstructor">no</a> <a id="808" href="SystemT.html#808" class="Bound">¬pf</a>   <a id="814" class="Symbol">|</a> <a id="816" href="Relation.Nullary.html#1685" class="InductiveConstructor">no</a> <a id="819" class="Symbol">_</a>      <a id="826" class="Symbol">=</a> <a id="828" href="Relation.Nullary.html#1685" class="InductiveConstructor">no</a> <a id="831" class="Symbol">(λ</a> <a id="834" class="Keyword">where</a> <a id="840" href="Agda.Builtin.Equality.html#208" class="InductiveConstructor">refl</a> <a id="845" class="Symbol">→</a> <a id="847" href="SystemT.html#808" class="Bound">¬pf</a> <a id="851" href="Agda.Builtin.Equality.html#208" class="InductiveConstructor">refl</a><a id="855" class="Symbol">)</a>
<a id="857" class="Symbol">...</a> <a id="861" class="Symbol">|</a> <a id="863" href="Relation.Nullary.html#1685" class="InductiveConstructor">no</a> <a id="866" href="SystemT.html#866" class="Bound">¬pf</a>   <a id="872" class="Symbol">|</a> <a id="874" href="Relation.Nullary.html#1648" class="InductiveConstructor">yes</a> <a id="878" class="Symbol">_</a>     <a id="884" class="Symbol">=</a> <a id="886" href="Relation.Nullary.html#1685" class="InductiveConstructor">no</a> <a id="889" class="Symbol">(λ</a> <a id="892" class="Keyword">where</a> <a id="898" href="Agda.Builtin.Equality.html#208" class="InductiveConstructor">refl</a> <a id="903" class="Symbol">→</a> <a id="905" href="SystemT.html#866" class="Bound">¬pf</a> <a id="909" href="Agda.Builtin.Equality.html#208" class="InductiveConstructor">refl</a> <a id="914" class="Symbol">)</a>
<a id="916" class="Symbol">...</a> <a id="920" class="Symbol">|</a> <a id="922" href="Relation.Nullary.html#1648" class="InductiveConstructor">yes</a> <a id="926" class="Symbol">_</a>    <a id="931" class="Symbol">|</a> <a id="933" href="Relation.Nullary.html#1685" class="InductiveConstructor">no</a> <a id="936" href="SystemT.html#936" class="Bound">¬pf</a>    <a id="943" class="Symbol">=</a> <a id="945" href="Relation.Nullary.html#1685" class="InductiveConstructor">no</a> <a id="948" class="Symbol">(λ</a> <a id="951" class="Keyword">where</a> <a id="957" href="Agda.Builtin.Equality.html#208" class="InductiveConstructor">refl</a> <a id="962" class="Symbol">→</a> <a id="964" href="SystemT.html#936" class="Bound">¬pf</a> <a id="968" href="Agda.Builtin.Equality.html#208" class="InductiveConstructor">refl</a><a id="972" class="Symbol">)</a>
<a id="974" class="Symbol">...</a> <a id="978" class="Symbol">|</a> <a id="980" href="Relation.Nullary.html#1648" class="InductiveConstructor">yes</a> <a id="984" href="Agda.Builtin.Equality.html#208" class="InductiveConstructor">refl</a> <a id="989" class="Symbol">|</a> <a id="991" href="Relation.Nullary.html#1648" class="InductiveConstructor">yes</a> <a id="995" href="Agda.Builtin.Equality.html#208" class="InductiveConstructor">refl</a>  <a id="1001" class="Symbol">=</a> <a id="1003" href="Relation.Nullary.html#1648" class="InductiveConstructor">yes</a> <a id="1007" href="Agda.Builtin.Equality.html#208" class="InductiveConstructor">refl</a>
</pre>
We continue with typing contexts, defined inductively with the empty
context, and extensions to contexts. As we are using a de Brujin index
representation, there are no names when extending contexts (and really
they are just lists of types).
<pre class="Agda"><a id="1267" class="Keyword">data</a> <a id="Γ"></a><a id="1272" href="SystemT.html#1272" class="Datatype">Γ</a> <a id="1274" class="Symbol">:</a> <a id="1276" href="Agda.Primitive.html#326" class="Primitive">Set</a> <a id="1280" class="Keyword">where</a>
  <a id="Γ.∅"></a><a id="1288" href="SystemT.html#1288" class="InductiveConstructor">∅</a> <a id="1290" class="Symbol">:</a> <a id="1292" href="SystemT.html#1272" class="Datatype">Γ</a>
  <a id="Γ._,_"></a><a id="1296" href="SystemT.html#1296" class="InductiveConstructor Operator">_,_</a> <a id="1300" class="Symbol">:</a> <a id="1302" href="SystemT.html#1272" class="Datatype">Γ</a> <a id="1304" class="Symbol">→</a> <a id="1306" href="SystemT.html#561" class="Datatype">Type</a> <a id="1311" class="Symbol">→</a> <a id="1313" href="SystemT.html#1272" class="Datatype">Γ</a>

<a id="1316" class="Keyword">infixl</a> <a id="1323" class="Number">5</a> <a id="1325" href="SystemT.html#1296" class="InductiveConstructor Operator">_,_</a>

<a id="_≟Γ_"></a><a id="1330" href="SystemT.html#1330" class="Function Operator">_≟Γ_</a> <a id="1335" class="Symbol">:</a> <a id="1337" class="Symbol">∀</a> <a id="1339" class="Symbol">(</a><a id="1340" href="SystemT.html#1340" class="Bound">Γ′</a> <a id="1343" href="SystemT.html#1343" class="Bound">Γ</a> <a id="1345" class="Symbol">:</a> <a id="1347" href="SystemT.html#1272" class="Datatype">Γ</a><a id="1348" class="Symbol">)</a> <a id="1350" class="Symbol">→</a> <a id="1352" href="Relation.Nullary.html#1511" class="Record">Dec</a> <a id="1356" class="Symbol">(</a><a id="1357" href="SystemT.html#1340" class="Bound">Γ′</a> <a id="1360" href="Agda.Builtin.Equality.html#151" class="Datatype Operator">≡</a> <a id="1362" href="SystemT.html#1343" class="Bound">Γ</a><a id="1363" class="Symbol">)</a>
<a id="1365" href="SystemT.html#1288" class="InductiveConstructor">∅</a> <a id="1367" href="SystemT.html#1330" class="Function Operator">≟Γ</a> <a id="1370" href="SystemT.html#1288" class="InductiveConstructor">∅</a> <a id="1372" class="Symbol">=</a> <a id="1374" href="Relation.Nullary.html#1648" class="InductiveConstructor">yes</a> <a id="1378" href="Agda.Builtin.Equality.html#208" class="InductiveConstructor">refl</a>
<a id="1383" href="SystemT.html#1288" class="InductiveConstructor">∅</a> <a id="1385" href="SystemT.html#1330" class="Function Operator">≟Γ</a> <a id="1388" class="Symbol">(_</a> <a id="1391" href="SystemT.html#1296" class="InductiveConstructor Operator">,</a> <a id="1393" class="Symbol">_)</a> <a id="1396" class="Symbol">=</a> <a id="1398" href="Relation.Nullary.html#1685" class="InductiveConstructor">no</a> <a id="1401" class="Symbol">λ()</a>
<a id="1405" class="Symbol">(_</a> <a id="1408" href="SystemT.html#1296" class="InductiveConstructor Operator">,</a> <a id="1410" class="Symbol">_)</a> <a id="1413" href="SystemT.html#1330" class="Function Operator">≟Γ</a> <a id="1416" href="SystemT.html#1288" class="InductiveConstructor">∅</a> <a id="1418" class="Symbol">=</a> <a id="1420" href="Relation.Nullary.html#1685" class="InductiveConstructor">no</a> <a id="1423" class="Symbol">λ()</a>
<a id="1427" class="Symbol">(</a><a id="1428" href="SystemT.html#1428" class="Bound">Γ′</a> <a id="1431" href="SystemT.html#1296" class="InductiveConstructor Operator">,</a> <a id="1433" href="SystemT.html#1433" class="Bound">S</a><a id="1434" class="Symbol">)</a> <a id="1436" href="SystemT.html#1330" class="Function Operator">≟Γ</a> <a id="1439" class="Symbol">(</a><a id="1440" href="SystemT.html#1440" class="Bound">Γ</a> <a id="1442" href="SystemT.html#1296" class="InductiveConstructor Operator">,</a> <a id="1444" href="SystemT.html#1444" class="Bound">T</a><a id="1445" class="Symbol">)</a> <a id="1447" class="Keyword">with</a> <a id="1452" href="SystemT.html#1428" class="Bound">Γ′</a> <a id="1455" href="SystemT.html#1330" class="Function Operator">≟Γ</a> <a id="1458" href="SystemT.html#1440" class="Bound">Γ</a> <a id="1460" class="Symbol">|</a> <a id="1462" href="SystemT.html#1433" class="Bound">S</a> <a id="1464" href="SystemT.html#636" class="Function Operator">≟Tp</a> <a id="1468" href="SystemT.html#1444" class="Bound">T</a>
<a id="1470" class="Symbol">...</a> <a id="1474" class="Symbol">|</a> <a id="1476" href="Relation.Nullary.html#1685" class="InductiveConstructor">no</a> <a id="1479" href="SystemT.html#1479" class="Bound">¬pf</a>   <a id="1485" class="Symbol">|</a> <a id="1487" href="Relation.Nullary.html#1685" class="InductiveConstructor">no</a> <a id="1490" class="Symbol">_</a>     <a id="1496" class="Symbol">=</a> <a id="1498" href="Relation.Nullary.html#1685" class="InductiveConstructor">no</a> <a id="1501" class="Symbol">(λ</a> <a id="1504" class="Keyword">where</a> <a id="1510" href="Agda.Builtin.Equality.html#208" class="InductiveConstructor">refl</a> <a id="1515" class="Symbol">→</a> <a id="1517" href="SystemT.html#1479" class="Bound">¬pf</a> <a id="1521" href="Agda.Builtin.Equality.html#208" class="InductiveConstructor">refl</a><a id="1525" class="Symbol">)</a>
<a id="1527" class="Symbol">...</a> <a id="1531" class="Symbol">|</a> <a id="1533" href="Relation.Nullary.html#1685" class="InductiveConstructor">no</a> <a id="1536" href="SystemT.html#1536" class="Bound">¬pf</a>   <a id="1542" class="Symbol">|</a> <a id="1544" href="Relation.Nullary.html#1648" class="InductiveConstructor">yes</a> <a id="1548" class="Symbol">_</a>    <a id="1553" class="Symbol">=</a> <a id="1555" href="Relation.Nullary.html#1685" class="InductiveConstructor">no</a> <a id="1558" class="Symbol">(λ</a> <a id="1561" class="Keyword">where</a> <a id="1567" href="Agda.Builtin.Equality.html#208" class="InductiveConstructor">refl</a> <a id="1572" class="Symbol">→</a> <a id="1574" href="SystemT.html#1536" class="Bound">¬pf</a> <a id="1578" href="Agda.Builtin.Equality.html#208" class="InductiveConstructor">refl</a><a id="1582" class="Symbol">)</a>
<a id="1584" class="Symbol">...</a> <a id="1588" class="Symbol">|</a> <a id="1590" href="Relation.Nullary.html#1648" class="InductiveConstructor">yes</a> <a id="1594" class="Symbol">_</a>    <a id="1599" class="Symbol">|</a> <a id="1601" href="Relation.Nullary.html#1685" class="InductiveConstructor">no</a> <a id="1604" href="SystemT.html#1604" class="Bound">¬pf</a>   <a id="1610" class="Symbol">=</a> <a id="1612" href="Relation.Nullary.html#1685" class="InductiveConstructor">no</a> <a id="1615" class="Symbol">(λ</a> <a id="1618" class="Keyword">where</a> <a id="1624" href="Agda.Builtin.Equality.html#208" class="InductiveConstructor">refl</a> <a id="1629" class="Symbol">→</a> <a id="1631" href="SystemT.html#1604" class="Bound">¬pf</a> <a id="1635" href="Agda.Builtin.Equality.html#208" class="InductiveConstructor">refl</a><a id="1639" class="Symbol">)</a>
<a id="1641" class="Symbol">...</a> <a id="1645" class="Symbol">|</a> <a id="1647" href="Relation.Nullary.html#1648" class="InductiveConstructor">yes</a> <a id="1651" href="Agda.Builtin.Equality.html#208" class="InductiveConstructor">refl</a> <a id="1656" class="Symbol">|</a> <a id="1658" href="Relation.Nullary.html#1648" class="InductiveConstructor">yes</a> <a id="1662" href="Agda.Builtin.Equality.html#208" class="InductiveConstructor">refl</a> <a id="1667" class="Symbol">=</a> <a id="1669" href="Relation.Nullary.html#1648" class="InductiveConstructor">yes</a> <a id="1673" href="Agda.Builtin.Equality.html#208" class="InductiveConstructor">refl</a>
</pre>
We also define a relation detailing when one context is the extension of
another, this is introduced formally in a later section but will be
useful throughout. A context is an extension of itself, and given that
one context Γ′ extends another context Γ, the first can be extended
further and the relation will still hold.
<pre class="Agda"><a id="2013" class="Keyword">data</a> <a id="_≤_"></a><a id="2018" href="SystemT.html#2018" class="Datatype Operator">_≤_</a> <a id="2022" class="Symbol">:</a> <a id="2024" href="SystemT.html#1272" class="Datatype">Γ</a> <a id="2026" class="Symbol">→</a> <a id="2028" href="SystemT.html#1272" class="Datatype">Γ</a> <a id="2030" class="Symbol">→</a> <a id="2032" href="Agda.Primitive.html#326" class="Primitive">Set</a> <a id="2036" class="Keyword">where</a>
  <a id="_≤_.≤-id"></a><a id="2044" href="SystemT.html#2044" class="InductiveConstructor">≤-id</a> <a id="2049" class="Symbol">:</a> <a id="2051" class="Symbol">∀</a> <a id="2053" class="Symbol">{</a><a id="2054" href="SystemT.html#2054" class="Bound">Γ</a> <a id="2056" class="Symbol">:</a> <a id="2058" href="SystemT.html#1272" class="Datatype">Γ</a><a id="2059" class="Symbol">}</a> <a id="2061" class="Symbol">→</a> <a id="2063" href="SystemT.html#2054" class="Bound">Γ</a> <a id="2065" href="SystemT.html#2018" class="Datatype Operator">≤</a> <a id="2067" href="SystemT.html#2054" class="Bound">Γ</a>

  <a id="_≤_.≤-ext"></a><a id="2072" href="SystemT.html#2072" class="InductiveConstructor">≤-ext</a> <a id="2078" class="Symbol">:</a> <a id="2080" class="Symbol">∀</a> <a id="2082" class="Symbol">{</a><a id="2083" href="SystemT.html#2083" class="Bound">Γ</a> <a id="2085" href="SystemT.html#2085" class="Bound">Γ′</a> <a id="2088" class="Symbol">:</a> <a id="2090" href="SystemT.html#1272" class="Datatype">Γ</a><a id="2091" class="Symbol">}</a> <a id="2093" class="Symbol">{</a><a id="2094" href="SystemT.html#2094" class="Bound">T</a> <a id="2096" class="Symbol">:</a> <a id="2098" href="SystemT.html#561" class="Datatype">Type</a><a id="2102" class="Symbol">}</a>
        <a id="2112" class="Symbol">→</a> <a id="2114" href="SystemT.html#2085" class="Bound">Γ′</a> <a id="2117" href="SystemT.html#2018" class="Datatype Operator">≤</a> <a id="2119" href="SystemT.html#2083" class="Bound">Γ</a>
          <a id="2131" class="Comment">----------</a>
        <a id="2150" class="Symbol">→</a> <a id="2152" href="SystemT.html#2085" class="Bound">Γ′</a> <a id="2155" href="SystemT.html#1296" class="InductiveConstructor Operator">,</a> <a id="2157" href="SystemT.html#2094" class="Bound">T</a> <a id="2159" href="SystemT.html#2018" class="Datatype Operator">≤</a> <a id="2161" href="SystemT.html#2083" class="Bound">Γ</a>

<a id="2164" class="Keyword">infix</a> <a id="2170" class="Number">4</a> <a id="2172" href="SystemT.html#2018" class="Datatype Operator">_≤_</a>

<a id="_≤?_"></a><a id="2177" href="SystemT.html#2177" class="Function Operator">_≤?_</a> <a id="2182" class="Symbol">:</a> <a id="2184" class="Symbol">∀</a> <a id="2186" class="Symbol">(</a><a id="2187" href="SystemT.html#2187" class="Bound">Γ′</a> <a id="2190" href="SystemT.html#2190" class="Bound">Γ</a> <a id="2192" class="Symbol">:</a> <a id="2194" href="SystemT.html#1272" class="Datatype">Γ</a><a id="2195" class="Symbol">)</a> <a id="2197" class="Symbol">→</a> <a id="2199" href="Relation.Nullary.html#1511" class="Record">Dec</a> <a id="2203" class="Symbol">(</a><a id="2204" href="SystemT.html#2187" class="Bound">Γ′</a> <a id="2207" href="SystemT.html#2018" class="Datatype Operator">≤</a> <a id="2209" href="SystemT.html#2190" class="Bound">Γ</a><a id="2210" class="Symbol">)</a>
<a id="2212" href="SystemT.html#1288" class="InductiveConstructor">∅</a> <a id="2214" href="SystemT.html#2177" class="Function Operator">≤?</a> <a id="2217" href="SystemT.html#1288" class="InductiveConstructor">∅</a> <a id="2219" class="Symbol">=</a> <a id="2221" href="Relation.Nullary.html#1648" class="InductiveConstructor">yes</a> <a id="2225" href="SystemT.html#2044" class="InductiveConstructor">≤-id</a>
<a id="2230" href="SystemT.html#1288" class="InductiveConstructor">∅</a> <a id="2232" href="SystemT.html#2177" class="Function Operator">≤?</a> <a id="2235" class="Symbol">(_</a> <a id="2238" href="SystemT.html#1296" class="InductiveConstructor Operator">,</a> <a id="2240" class="Symbol">_)</a> <a id="2243" class="Symbol">=</a> <a id="2245" href="Relation.Nullary.html#1685" class="InductiveConstructor">no</a> <a id="2248" class="Symbol">λ()</a>
<a id="2252" class="Symbol">(_</a> <a id="2255" href="SystemT.html#1296" class="InductiveConstructor Operator">,</a> <a id="2257" class="Symbol">_)</a> <a id="2260" href="SystemT.html#2177" class="Function Operator">≤?</a> <a id="2263" href="SystemT.html#1288" class="InductiveConstructor">∅</a> <a id="2265" class="Symbol">=</a> <a id="2267" href="Relation.Nullary.html#1648" class="InductiveConstructor">yes</a> <a id="2271" href="SystemT.html#2283" class="Function">Γ≤∅</a> <a id="2275" class="Keyword">where</a>
  <a id="2283" href="SystemT.html#2283" class="Function">Γ≤∅</a> <a id="2287" class="Symbol">:</a> <a id="2289" class="Symbol">∀</a> <a id="2291" class="Symbol">{</a><a id="2292" href="SystemT.html#2292" class="Bound">Γ</a> <a id="2294" class="Symbol">:</a> <a id="2296" href="SystemT.html#1272" class="Datatype">Γ</a><a id="2297" class="Symbol">}</a> <a id="2299" class="Symbol">→</a> <a id="2301" href="SystemT.html#2292" class="Bound">Γ</a> <a id="2303" href="SystemT.html#2018" class="Datatype Operator">≤</a> <a id="2305" href="SystemT.html#1288" class="InductiveConstructor">∅</a>
  <a id="2309" href="SystemT.html#2283" class="Function">Γ≤∅</a> <a id="2313" class="Symbol">{</a><a id="2314" href="SystemT.html#1288" class="InductiveConstructor">∅</a><a id="2315" class="Symbol">}</a> <a id="2317" class="Symbol">=</a> <a id="2319" href="SystemT.html#2044" class="InductiveConstructor">≤-id</a>
  <a id="2326" href="SystemT.html#2283" class="Function">Γ≤∅</a> <a id="2330" class="Symbol">{</a><a id="2331" href="SystemT.html#2331" class="Bound">Γ</a> <a id="2333" href="SystemT.html#1296" class="InductiveConstructor Operator">,</a> <a id="2335" class="Symbol">_}</a> <a id="2338" class="Keyword">with</a> <a id="2343" href="SystemT.html#2283" class="Function">Γ≤∅</a> <a id="2347" class="Symbol">{</a><a id="2348" href="SystemT.html#2331" class="Bound">Γ</a><a id="2349" class="Symbol">}</a>
  <a id="2353" class="Symbol">...</a> <a id="2357" class="Symbol">|</a> <a id="2359" href="SystemT.html#2359" class="Bound">pf</a> <a id="2362" class="Symbol">=</a> <a id="2364" href="SystemT.html#2072" class="InductiveConstructor">≤-ext</a> <a id="2370" href="SystemT.html#2359" class="Bound">pf</a>
<a id="2373" class="Symbol">(</a><a id="2374" href="SystemT.html#2374" class="Bound">Γ′</a> <a id="2377" href="SystemT.html#1296" class="InductiveConstructor Operator">,</a> <a id="2379" href="SystemT.html#2379" class="Bound">T</a><a id="2380" class="Symbol">)</a> <a id="2382" href="SystemT.html#2177" class="Function Operator">≤?</a> <a id="2385" href="SystemT.html#2385" class="Bound">Γ</a><a id="2386" class="Symbol">@(_</a> <a id="2390" href="SystemT.html#1296" class="InductiveConstructor Operator">,</a> <a id="2392" class="Symbol">_)</a>
  <a id="2397" class="Keyword">with</a> <a id="2402" class="Symbol">(</a><a id="2403" href="SystemT.html#2374" class="Bound">Γ′</a> <a id="2406" href="SystemT.html#1296" class="InductiveConstructor Operator">,</a> <a id="2408" href="SystemT.html#2379" class="Bound">T</a><a id="2409" class="Symbol">)</a> <a id="2411" href="SystemT.html#1330" class="Function Operator">≟Γ</a> <a id="2414" href="SystemT.html#2385" class="Bound">Γ</a>
<a id="2416" class="Symbol">...</a> <a id="2420" class="Symbol">|</a> <a id="2422" href="Relation.Nullary.html#1648" class="InductiveConstructor">yes</a> <a id="2426" href="Agda.Builtin.Equality.html#208" class="InductiveConstructor">refl</a> <a id="2431" class="Symbol">=</a> <a id="2433" href="Relation.Nullary.html#1648" class="InductiveConstructor">yes</a> <a id="2437" href="SystemT.html#2044" class="InductiveConstructor">≤-id</a>
<a id="2442" class="Symbol">...</a> <a id="2446" class="Symbol">|</a> <a id="2448" href="Relation.Nullary.html#1685" class="InductiveConstructor">no</a> <a id="2451" href="SystemT.html#2451" class="Bound">Γ′≢Γ</a>
  <a id="2458" class="Keyword">with</a> <a id="2463" class="Bound">Γ′</a> <a id="2466" href="SystemT.html#2177" class="Function Operator">≤?</a> <a id="2469" class="Bound">Γ</a>
<a id="2471" class="Symbol">...</a> <a id="2475" class="Symbol">|</a> <a id="2477" href="Relation.Nullary.html#1648" class="InductiveConstructor">yes</a> <a id="2481" href="SystemT.html#2481" class="Bound">pf</a> <a id="2484" class="Symbol">=</a> <a id="2486" href="Relation.Nullary.html#1648" class="InductiveConstructor">yes</a> <a id="2490" class="Symbol">(</a><a id="2491" href="SystemT.html#2072" class="InductiveConstructor">≤-ext</a> <a id="2497" href="SystemT.html#2481" class="Bound">pf</a><a id="2499" class="Symbol">)</a>
<a id="2501" class="Symbol">...</a> <a id="2505" class="Symbol">|</a> <a id="2507" href="Relation.Nullary.html#1685" class="InductiveConstructor">no</a> <a id="2510" href="SystemT.html#2510" class="Bound">¬pf</a> <a id="2514" class="Symbol">=</a>
  <a id="2518" href="Relation.Nullary.html#1685" class="InductiveConstructor">no</a> <a id="2521" class="Symbol">λ</a> <a id="2523" class="Keyword">where</a>
    <a id="2533" href="SystemT.html#2044" class="InductiveConstructor">≤-id</a> <a id="2538" class="Symbol">→</a> <a id="2540" class="Bound">Γ′≢Γ</a> <a id="2545" href="Agda.Builtin.Equality.html#208" class="InductiveConstructor">refl</a>
    <a id="2554" class="Symbol">(</a><a id="2555" href="SystemT.html#2072" class="InductiveConstructor">≤-ext</a> <a id="2561" href="SystemT.html#2561" class="Bound">pf</a><a id="2563" class="Symbol">)</a> <a id="2565" class="Symbol">→</a> <a id="2567" href="SystemT.html#2510" class="Bound">¬pf</a> <a id="2571" href="SystemT.html#2561" class="Bound">pf</a>
</pre>
We also introduce a lookup judgement for contexts, which corresponds to
a de Brujin index.
<pre class="Agda"><a id="2678" class="Keyword">data</a> <a id="_∋_"></a><a id="2683" href="SystemT.html#2683" class="Datatype Operator">_∋_</a> <a id="2687" class="Symbol">:</a> <a id="2689" href="SystemT.html#1272" class="Datatype">Γ</a> <a id="2691" class="Symbol">→</a> <a id="2693" href="SystemT.html#561" class="Datatype">Type</a> <a id="2698" class="Symbol">→</a> <a id="2700" href="Agda.Primitive.html#326" class="Primitive">Set</a> <a id="2704" class="Keyword">where</a>
  <a id="_∋_.`Z"></a><a id="2712" href="SystemT.html#2712" class="InductiveConstructor">`Z</a> <a id="2715" class="Symbol">:</a> <a id="2717" class="Symbol">∀</a> <a id="2719" class="Symbol">{</a><a id="2720" href="SystemT.html#2720" class="Bound">Γ</a> <a id="2722" class="Symbol">:</a> <a id="2724" href="SystemT.html#1272" class="Datatype">Γ</a><a id="2725" class="Symbol">}</a> <a id="2727" class="Symbol">{</a><a id="2728" href="SystemT.html#2728" class="Bound">T</a> <a id="2730" class="Symbol">:</a> <a id="2732" href="SystemT.html#561" class="Datatype">Type</a><a id="2736" class="Symbol">}</a>
        <a id="2746" class="Comment">---------</a>
      <a id="2762" class="Symbol">→</a> <a id="2764" href="SystemT.html#2720" class="Bound">Γ</a> <a id="2766" href="SystemT.html#1296" class="InductiveConstructor Operator">,</a> <a id="2768" href="SystemT.html#2728" class="Bound">T</a> <a id="2770" href="SystemT.html#2683" class="Datatype Operator">∋</a> <a id="2772" href="SystemT.html#2728" class="Bound">T</a>

  <a id="_∋_.`S_"></a><a id="2777" href="SystemT.html#2777" class="InductiveConstructor Operator">`S_</a> <a id="2781" class="Symbol">:</a> <a id="2783" class="Symbol">∀</a> <a id="2785" class="Symbol">{</a><a id="2786" href="SystemT.html#2786" class="Bound">Γ</a> <a id="2788" class="Symbol">:</a> <a id="2790" href="SystemT.html#1272" class="Datatype">Γ</a><a id="2791" class="Symbol">}</a> <a id="2793" class="Symbol">{</a><a id="2794" href="SystemT.html#2794" class="Bound">S</a> <a id="2796" href="SystemT.html#2796" class="Bound">T</a> <a id="2798" class="Symbol">:</a> <a id="2800" href="SystemT.html#561" class="Datatype">Type</a><a id="2804" class="Symbol">}</a>
      <a id="2812" class="Symbol">→</a> <a id="2814" href="SystemT.html#2786" class="Bound">Γ</a> <a id="2816" href="SystemT.html#2683" class="Datatype Operator">∋</a> <a id="2818" href="SystemT.html#2796" class="Bound">T</a>
        <a id="2828" class="Comment">---------</a>
      <a id="2844" class="Symbol">→</a> <a id="2846" href="SystemT.html#2786" class="Bound">Γ</a> <a id="2848" href="SystemT.html#1296" class="InductiveConstructor Operator">,</a> <a id="2850" href="SystemT.html#2794" class="Bound">S</a> <a id="2852" href="SystemT.html#2683" class="Datatype Operator">∋</a> <a id="2854" href="SystemT.html#2796" class="Bound">T</a>

<a id="2857" class="Keyword">infix</a> <a id="2863" class="Number">4</a> <a id="2865" href="SystemT.html#2683" class="Datatype Operator">_∋_</a>
</pre>
<p>Terms in our language are defined with an intrinsically typed
represenation, such that a term t of type Γ ⊢ T is the term
<code>Γ ⊢ t : T</code> itself. The language has the constants
<code>zero</code>, <code>suc</code> (as a curried
constant),<code>rec</code> (a curried constant as well), variables,
abstractions, and application.</p>
For clarity we will not use an intrinsically typed de Brujin
representation when talking about terms (e.g. the variable
<code></code>Z will be talked about as <code>Γ , x:T ⊢ x : T</code>)
<pre class="Agda"><a id="3340" class="Keyword">data</a> <a id="_⊢_"></a><a id="3345" href="SystemT.html#3345" class="Datatype Operator">_⊢_</a> <a id="3349" class="Symbol">(</a><a id="3350" href="SystemT.html#3350" class="Bound">Γ</a> <a id="3352" class="Symbol">:</a> <a id="3354" href="SystemT.html#1272" class="Datatype">Γ</a><a id="3355" class="Symbol">)</a> <a id="3357" class="Symbol">:</a> <a id="3359" href="SystemT.html#561" class="Datatype">Type</a> <a id="3364" class="Symbol">→</a> <a id="3366" href="Agda.Primitive.html#326" class="Primitive">Set</a> <a id="3370" class="Keyword">where</a>
  <a id="_⊢_.zero"></a><a id="3378" href="SystemT.html#3378" class="InductiveConstructor">zero</a> <a id="3383" class="Symbol">:</a> <a id="3385" href="SystemT.html#3350" class="Bound">Γ</a> <a id="3387" href="SystemT.html#3345" class="Datatype Operator">⊢</a> <a id="3389" href="SystemT.html#580" class="InductiveConstructor">nat</a>

  <a id="_⊢_.suc"></a><a id="3396" href="SystemT.html#3396" class="InductiveConstructor">suc</a> <a id="3400" class="Symbol">:</a> <a id="3402" href="SystemT.html#3350" class="Bound">Γ</a> <a id="3404" href="SystemT.html#3345" class="Datatype Operator">⊢</a> <a id="3406" href="SystemT.html#580" class="InductiveConstructor">nat</a> <a id="3410" href="SystemT.html#593" class="InductiveConstructor Operator">⇒</a> <a id="3412" href="SystemT.html#580" class="InductiveConstructor">nat</a>

  <a id="_⊢_.rec"></a><a id="3419" href="SystemT.html#3419" class="InductiveConstructor">rec</a>  <a id="3424" class="Symbol">:</a> <a id="3426" class="Symbol">∀</a> <a id="3428" class="Symbol">{</a><a id="3429" href="SystemT.html#3429" class="Bound">T</a> <a id="3431" class="Symbol">:</a> <a id="3433" href="SystemT.html#561" class="Datatype">Type</a><a id="3437" class="Symbol">}</a>
         <a id="3448" class="Comment">---------------------------------</a>
       <a id="3489" class="Symbol">→</a> <a id="3491" href="SystemT.html#3350" class="Bound">Γ</a> <a id="3493" href="SystemT.html#3345" class="Datatype Operator">⊢</a> <a id="3495" class="Symbol">(</a><a id="3496" href="SystemT.html#3429" class="Bound">T</a> <a id="3498" href="SystemT.html#593" class="InductiveConstructor Operator">⇒</a> <a id="3500" class="Symbol">(</a><a id="3501" href="SystemT.html#580" class="InductiveConstructor">nat</a> <a id="3505" href="SystemT.html#593" class="InductiveConstructor Operator">⇒</a> <a id="3507" href="SystemT.html#3429" class="Bound">T</a> <a id="3509" href="SystemT.html#593" class="InductiveConstructor Operator">⇒</a> <a id="3511" href="SystemT.html#3429" class="Bound">T</a><a id="3512" class="Symbol">)</a> <a id="3514" href="SystemT.html#593" class="InductiveConstructor Operator">⇒</a> <a id="3516" href="SystemT.html#580" class="InductiveConstructor">nat</a> <a id="3520" href="SystemT.html#593" class="InductiveConstructor Operator">⇒</a> <a id="3522" href="SystemT.html#3429" class="Bound">T</a><a id="3523" class="Symbol">)</a>

  <a id="_⊢_.`_"></a><a id="3528" href="SystemT.html#3528" class="InductiveConstructor Operator">`_</a> <a id="3531" class="Symbol">:</a> <a id="3533" class="Symbol">∀</a> <a id="3535" class="Symbol">{</a><a id="3536" href="SystemT.html#3536" class="Bound">S</a> <a id="3538" class="Symbol">:</a> <a id="3540" href="SystemT.html#561" class="Datatype">Type</a><a id="3544" class="Symbol">}</a>
     <a id="3551" class="Symbol">→</a> <a id="3553" href="SystemT.html#3350" class="Bound">Γ</a> <a id="3555" href="SystemT.html#2683" class="Datatype Operator">∋</a> <a id="3557" href="SystemT.html#3536" class="Bound">S</a>
       <a id="3566" class="Comment">-----</a>
     <a id="3577" class="Symbol">→</a> <a id="3579" href="SystemT.html#3350" class="Bound">Γ</a> <a id="3581" href="SystemT.html#3345" class="Datatype Operator">⊢</a> <a id="3583" href="SystemT.html#3536" class="Bound">S</a>

  <a id="_⊢_.ƛ_"></a><a id="3588" href="SystemT.html#3588" class="InductiveConstructor Operator">ƛ_</a> <a id="3591" class="Symbol">:</a> <a id="3593" class="Symbol">∀</a> <a id="3595" class="Symbol">{</a><a id="3596" href="SystemT.html#3596" class="Bound">S</a> <a id="3598" href="SystemT.html#3598" class="Bound">T</a> <a id="3600" class="Symbol">:</a> <a id="3602" href="SystemT.html#561" class="Datatype">Type</a><a id="3606" class="Symbol">}</a>
     <a id="3613" class="Symbol">→</a> <a id="3615" href="SystemT.html#3350" class="Bound">Γ</a> <a id="3617" href="SystemT.html#1296" class="InductiveConstructor Operator">,</a> <a id="3619" href="SystemT.html#3596" class="Bound">S</a> <a id="3621" href="SystemT.html#3345" class="Datatype Operator">⊢</a> <a id="3623" href="SystemT.html#3598" class="Bound">T</a>
       <a id="3632" class="Comment">---------</a>
     <a id="3647" class="Symbol">→</a> <a id="3649" href="SystemT.html#3350" class="Bound">Γ</a> <a id="3651" href="SystemT.html#3345" class="Datatype Operator">⊢</a> <a id="3653" href="SystemT.html#3596" class="Bound">S</a> <a id="3655" href="SystemT.html#593" class="InductiveConstructor Operator">⇒</a> <a id="3657" href="SystemT.html#3598" class="Bound">T</a>

  <a id="_⊢_._·_"></a><a id="3662" href="SystemT.html#3662" class="InductiveConstructor Operator">_·_</a> <a id="3666" class="Symbol">:</a> <a id="3668" class="Symbol">∀</a> <a id="3670" class="Symbol">{</a><a id="3671" href="SystemT.html#3671" class="Bound">S</a> <a id="3673" href="SystemT.html#3673" class="Bound">T</a> <a id="3675" class="Symbol">:</a> <a id="3677" href="SystemT.html#561" class="Datatype">Type</a><a id="3681" class="Symbol">}</a>
      <a id="3689" class="Symbol">→</a> <a id="3691" href="SystemT.html#3350" class="Bound">Γ</a> <a id="3693" href="SystemT.html#3345" class="Datatype Operator">⊢</a> <a id="3695" href="SystemT.html#3671" class="Bound">S</a> <a id="3697" href="SystemT.html#593" class="InductiveConstructor Operator">⇒</a> <a id="3699" href="SystemT.html#3673" class="Bound">T</a>
      <a id="3707" class="Symbol">→</a> <a id="3709" href="SystemT.html#3350" class="Bound">Γ</a> <a id="3711" href="SystemT.html#3345" class="Datatype Operator">⊢</a> <a id="3713" href="SystemT.html#3671" class="Bound">S</a>
        <a id="3723" class="Comment">---------</a>
      <a id="3739" class="Symbol">→</a> <a id="3741" href="SystemT.html#3350" class="Bound">Γ</a> <a id="3743" href="SystemT.html#3345" class="Datatype Operator">⊢</a> <a id="3745" href="SystemT.html#3673" class="Bound">T</a>

<a id="3748" class="Keyword">infix</a> <a id="3754" class="Number">4</a> <a id="3756" href="SystemT.html#3345" class="Datatype Operator">_⊢_</a>
<a id="3760" class="Keyword">infix</a> <a id="3766" class="Number">5</a> <a id="3768" href="SystemT.html#3588" class="InductiveConstructor Operator">ƛ_</a>
<a id="3771" class="Keyword">infixl</a> <a id="3778" class="Number">7</a> <a id="3780" href="SystemT.html#3662" class="InductiveConstructor Operator">_·_</a>
<a id="3784" class="Keyword">infix</a> <a id="3790" class="Number">9</a> <a id="3792" href="SystemT.html#3528" class="InductiveConstructor Operator">`_</a>
</pre>
We can define some sample programs in the language using these
constructors:
<pre class="Agda"><a id="3885" class="Comment">-- λx. x</a>
<a id="ex0"></a><a id="3894" href="SystemT.html#3894" class="Function">ex0</a> <a id="3898" class="Symbol">:</a> <a id="3900" class="Symbol">∀</a> <a id="3902" class="Symbol">{</a><a id="3903" href="SystemT.html#3903" class="Bound">Γ</a> <a id="3905" class="Symbol">:</a> <a id="3907" href="SystemT.html#1272" class="Datatype">Γ</a><a id="3908" class="Symbol">}</a> <a id="3910" class="Symbol">{</a><a id="3911" href="SystemT.html#3911" class="Bound">T</a> <a id="3913" class="Symbol">:</a> <a id="3915" href="SystemT.html#561" class="Datatype">Type</a><a id="3919" class="Symbol">}</a> <a id="3921" class="Symbol">→</a> <a id="3923" href="SystemT.html#3903" class="Bound">Γ</a> <a id="3925" href="SystemT.html#3345" class="Datatype Operator">⊢</a> <a id="3927" href="SystemT.html#3911" class="Bound">T</a> <a id="3929" href="SystemT.html#593" class="InductiveConstructor Operator">⇒</a> <a id="3931" href="SystemT.html#3911" class="Bound">T</a>
<a id="3933" href="SystemT.html#3894" class="Function">ex0</a> <a id="3937" class="Symbol">=</a> <a id="3939" href="SystemT.html#3588" class="InductiveConstructor Operator">ƛ</a> <a id="3941" href="SystemT.html#3528" class="InductiveConstructor Operator">`</a> <a id="3943" class="Symbol">(</a><a id="3944" href="SystemT.html#2712" class="InductiveConstructor">`Z</a><a id="3946" class="Symbol">)</a>

<a id="3949" class="Comment">-- (λx. x) zero</a>
<a id="ex1"></a><a id="3965" href="SystemT.html#3965" class="Function">ex1</a> <a id="3969" class="Symbol">=</a> <a id="3971" href="SystemT.html#3894" class="Function">ex0</a> <a id="3975" href="SystemT.html#3662" class="InductiveConstructor Operator">·</a> <a id="3977" href="SystemT.html#3378" class="InductiveConstructor">zero</a> <a id="3982" class="Symbol">{</a><a id="3983" href="SystemT.html#1288" class="InductiveConstructor">∅</a><a id="3984" class="Symbol">}</a>

<a id="3987" class="Comment">-- suc ((λx. x) zero)</a>
<a id="ex2"></a><a id="4009" href="SystemT.html#4009" class="Function">ex2</a> <a id="4013" class="Symbol">=</a> <a id="4015" href="SystemT.html#3396" class="InductiveConstructor">suc</a> <a id="4019" href="SystemT.html#3662" class="InductiveConstructor Operator">·</a> <a id="4021" href="SystemT.html#3965" class="Function">ex1</a>

<a id="4026" class="Comment">-- x:nat, y:nat ⊢ suc ((λz. suc y) x)</a>
<a id="ex3"></a><a id="4064" href="SystemT.html#4064" class="Function">ex3</a> <a id="4068" class="Symbol">:</a> <a id="4070" href="SystemT.html#1288" class="InductiveConstructor">∅</a> <a id="4072" href="SystemT.html#1296" class="InductiveConstructor Operator">,</a> <a id="4074" href="SystemT.html#580" class="InductiveConstructor">nat</a> <a id="4078" href="SystemT.html#1296" class="InductiveConstructor Operator">,</a> <a id="4080" href="SystemT.html#580" class="InductiveConstructor">nat</a> <a id="4084" href="SystemT.html#3345" class="Datatype Operator">⊢</a> <a id="4086" href="SystemT.html#580" class="InductiveConstructor">nat</a>
<a id="4090" href="SystemT.html#4064" class="Function">ex3</a> <a id="4094" class="Symbol">=</a> <a id="4096" href="SystemT.html#3396" class="InductiveConstructor">suc</a> <a id="4100" href="SystemT.html#3662" class="InductiveConstructor Operator">·</a> <a id="4102" class="Symbol">((</a><a id="4104" href="SystemT.html#3588" class="InductiveConstructor Operator">ƛ</a> <a id="4106" href="SystemT.html#3396" class="InductiveConstructor">suc</a> <a id="4110" href="SystemT.html#3662" class="InductiveConstructor Operator">·</a> <a id="4112" href="SystemT.html#3528" class="InductiveConstructor Operator">`</a> <a id="4114" class="Symbol">(</a><a id="4115" href="SystemT.html#2777" class="InductiveConstructor Operator">`S</a> <a id="4118" href="SystemT.html#2712" class="InductiveConstructor">`Z</a><a id="4120" class="Symbol">))</a> <a id="4123" href="SystemT.html#3662" class="InductiveConstructor Operator">·</a> <a id="4125" href="SystemT.html#3528" class="InductiveConstructor Operator">`</a> <a id="4127" class="Symbol">(</a><a id="4128" href="SystemT.html#2777" class="InductiveConstructor Operator">`S</a> <a id="4131" href="SystemT.html#2712" class="InductiveConstructor">`Z</a><a id="4133" class="Symbol">))</a>
</pre>
<p>Now that we have defined our language, we are almost ready to start
describing an algorithm for normalization by evaluation. However, to
prove the soundness of this algorithm, we will need to define two more
basic language constructs: substitutions and equality.</p>
<p>We expect the following soundness properties for a normalization
algorithm nf(t) that produces a normal form for a typed term
<code>Γ ⊢ t : T</code>:</p>
<ul>
<li><code>Γ ⊢ nf(t) : T</code> (well-typedness of normal form)</li>
<li><code>⟦ nf(t) ⟧ = ⟦ t ⟧</code> (preservation of meaning)</li>
<li><code>nf(nf(t)) = nf(t)</code> (idempotency)</li>
</ul>
<p>For preservation of meaning, our interpretations of functional terms
are functions, whose equality is undecidable. However, in STLC, we have
that two terms are βη-equivalent iff their interpretationss are equal.
So, we wish to define an extension of βη-equivalence for System T s.t.
it implies equal interpretations (thus making the proposition
<code>⟦ nf(t) ⟧ = ⟦ t ⟧</code> decidable).</p>
<p>To define our extension of βη-equivalence, we begin by defining
substitution (which we will use to define β-reductions and
η-expansions).</p>
<p>Substitution for System T is defined using the rules for parallel
substitution and the rule for the application of a substitution as they
are introduced in section 2.6.</p>
<p>A parallel substitution <code>Γ ⊢ σ : Δ</code> provides a well-typed
term in Γ to substitute for each variable in the context Δ.</p>
We use ⊩ instead of ⊢ since that is already reserved for typing
judgements (and keep using ∥ for the “parallel” in “parallel
substitutions” for operations related to this type).
<pre class="Agda"><a id="5678" class="Keyword">data</a> <a id="_⊩_"></a><a id="5683" href="SystemT.html#5683" class="Datatype Operator">_⊩_</a> <a id="5687" class="Symbol">:</a> <a id="5689" href="SystemT.html#1272" class="Datatype">Γ</a> <a id="5691" class="Symbol">→</a> <a id="5693" href="SystemT.html#1272" class="Datatype">Γ</a> <a id="5695" class="Symbol">→</a> <a id="5697" href="Agda.Primitive.html#326" class="Primitive">Set</a> <a id="5701" class="Keyword">where</a>
  <a id="_⊩_.∅"></a><a id="5709" href="SystemT.html#5709" class="InductiveConstructor">∅</a> <a id="5711" class="Symbol">:</a> <a id="5713" class="Symbol">∀</a> <a id="5715" class="Symbol">{</a><a id="5716" href="SystemT.html#5716" class="Bound">Γ</a><a id="5717" class="Symbol">}</a> <a id="5719" class="Symbol">→</a> <a id="5721" href="SystemT.html#5716" class="Bound">Γ</a> <a id="5723" href="SystemT.html#5683" class="Datatype Operator">⊩</a> <a id="5725" href="SystemT.html#1288" class="InductiveConstructor">∅</a>

  <a id="_⊩_._,_"></a><a id="5730" href="SystemT.html#5730" class="InductiveConstructor Operator">_,_</a> <a id="5734" class="Symbol">:</a> <a id="5736" class="Symbol">∀</a> <a id="5738" class="Symbol">{</a><a id="5739" href="SystemT.html#5739" class="Bound">Γ</a> <a id="5741" href="SystemT.html#5741" class="Bound">Δ</a> <a id="5743" class="Symbol">:</a> <a id="5745" href="SystemT.html#1272" class="Datatype">Γ</a><a id="5746" class="Symbol">}</a> <a id="5748" class="Symbol">{</a><a id="5749" href="SystemT.html#5749" class="Bound">S</a> <a id="5751" class="Symbol">:</a> <a id="5753" href="SystemT.html#561" class="Datatype">Type</a><a id="5757" class="Symbol">}</a>
        <a id="5767" class="Symbol">→</a> <a id="5769" href="SystemT.html#5739" class="Bound">Γ</a> <a id="5771" href="SystemT.html#5683" class="Datatype Operator">⊩</a> <a id="5773" href="SystemT.html#5741" class="Bound">Δ</a>
        <a id="5783" class="Symbol">→</a> <a id="5785" href="SystemT.html#5739" class="Bound">Γ</a> <a id="5787" href="SystemT.html#3345" class="Datatype Operator">⊢</a> <a id="5789" href="SystemT.html#5749" class="Bound">S</a>
          <a id="5801" class="Comment">---------</a>
        <a id="5819" class="Symbol">→</a> <a id="5821" href="SystemT.html#5739" class="Bound">Γ</a> <a id="5823" href="SystemT.html#5683" class="Datatype Operator">⊩</a> <a id="5825" href="SystemT.html#5741" class="Bound">Δ</a> <a id="5827" href="SystemT.html#1296" class="InductiveConstructor Operator">,</a> <a id="5829" href="SystemT.html#5749" class="Bound">S</a>

<a id="5832" class="Keyword">infix</a> <a id="5838" class="Number">4</a> <a id="5840" href="SystemT.html#5683" class="Datatype Operator">_⊩_</a>
</pre>
<p>Before defining the application of a substitution
<code>Γ ⊢ t [ σ ] :</code>T, we introduce renaming.</p>
<p>Renaming is a specialized substitution where we can only substitute
variables with other variables (i.e. a renaming <code>Γ ⊢ σᵨ : Δ</code>
provides a variable in Γ to replace for every variable in Δ).</p>
<p>It is necessary to first to define renamign substitutions so that
termination is guaranteed for our operations.</p>
We will use the subscript ‘ᵨ’ to indicate a renaming substitution.
<pre class="Agda"><a id="6322" class="Keyword">data</a> <a id="_⊩ᵨ_"></a><a id="6327" href="SystemT.html#6327" class="Datatype Operator">_⊩ᵨ_</a> <a id="6332" class="Symbol">:</a> <a id="6334" href="SystemT.html#1272" class="Datatype">Γ</a> <a id="6336" class="Symbol">→</a> <a id="6338" href="SystemT.html#1272" class="Datatype">Γ</a> <a id="6340" class="Symbol">→</a> <a id="6342" href="Agda.Primitive.html#326" class="Primitive">Set</a> <a id="6346" class="Keyword">where</a>
  <a id="_⊩ᵨ_.∅"></a><a id="6354" href="SystemT.html#6354" class="InductiveConstructor">∅</a> <a id="6356" class="Symbol">:</a> <a id="6358" class="Symbol">∀</a> <a id="6360" class="Symbol">{</a><a id="6361" href="SystemT.html#6361" class="Bound">Γ</a> <a id="6363" class="Symbol">:</a> <a id="6365" href="SystemT.html#1272" class="Datatype">Γ</a><a id="6366" class="Symbol">}</a> <a id="6368" class="Symbol">→</a> <a id="6370" href="SystemT.html#6361" class="Bound">Γ</a> <a id="6372" href="SystemT.html#6327" class="Datatype Operator">⊩ᵨ</a> <a id="6375" href="SystemT.html#1288" class="InductiveConstructor">∅</a>

  <a id="_⊩ᵨ_._,_"></a><a id="6380" href="SystemT.html#6380" class="InductiveConstructor Operator">_,_</a> <a id="6384" class="Symbol">:</a> <a id="6386" class="Symbol">∀</a> <a id="6388" class="Symbol">{</a><a id="6389" href="SystemT.html#6389" class="Bound">Γ</a> <a id="6391" href="SystemT.html#6391" class="Bound">Δ</a> <a id="6393" class="Symbol">:</a> <a id="6395" href="SystemT.html#1272" class="Datatype">Γ</a><a id="6396" class="Symbol">}</a> <a id="6398" class="Symbol">{</a><a id="6399" href="SystemT.html#6399" class="Bound">S</a> <a id="6401" class="Symbol">:</a> <a id="6403" href="SystemT.html#561" class="Datatype">Type</a><a id="6407" class="Symbol">}</a>
      <a id="6415" class="Symbol">→</a> <a id="6417" href="SystemT.html#6389" class="Bound">Γ</a> <a id="6419" href="SystemT.html#6327" class="Datatype Operator">⊩ᵨ</a> <a id="6422" href="SystemT.html#6391" class="Bound">Δ</a>
      <a id="6430" class="Symbol">→</a> <a id="6432" href="SystemT.html#6389" class="Bound">Γ</a> <a id="6434" href="SystemT.html#2683" class="Datatype Operator">∋</a> <a id="6436" href="SystemT.html#6399" class="Bound">S</a>
        <a id="6446" class="Comment">------------</a>
      <a id="6465" class="Symbol">→</a> <a id="6467" href="SystemT.html#6389" class="Bound">Γ</a> <a id="6469" href="SystemT.html#6327" class="Datatype Operator">⊩ᵨ</a> <a id="6472" class="Symbol">(</a><a id="6473" href="SystemT.html#6391" class="Bound">Δ</a> <a id="6475" href="SystemT.html#1296" class="InductiveConstructor Operator">,</a> <a id="6477" href="SystemT.html#6399" class="Bound">S</a><a id="6478" class="Symbol">)</a>

<a id="6481" class="Keyword">infix</a> <a id="6487" class="Number">4</a> <a id="6489" href="SystemT.html#6327" class="Datatype Operator">_⊩ᵨ_</a>
</pre>
We can use a renaming substitution to convert lookup judgements
(i.e. rename variables). In fact, this is the operation that we need to
define separately to guarantee termination of the application of a
substitution.
<pre class="Agda"><a id="rename"></a><a id="6724" href="SystemT.html#6724" class="Function">rename</a> <a id="6731" class="Symbol">:</a> <a id="6733" class="Symbol">∀</a> <a id="6735" class="Symbol">{</a><a id="6736" href="SystemT.html#6736" class="Bound">Γ</a> <a id="6738" href="SystemT.html#6738" class="Bound">Δ</a> <a id="6740" class="Symbol">:</a> <a id="6742" href="SystemT.html#1272" class="Datatype">Γ</a><a id="6743" class="Symbol">}</a> <a id="6745" class="Symbol">{</a><a id="6746" href="SystemT.html#6746" class="Bound">T</a> <a id="6748" class="Symbol">:</a> <a id="6750" href="SystemT.html#561" class="Datatype">Type</a><a id="6754" class="Symbol">}</a>
       <a id="6763" class="Symbol">→</a> <a id="6765" href="SystemT.html#6738" class="Bound">Δ</a> <a id="6767" href="SystemT.html#2683" class="Datatype Operator">∋</a> <a id="6769" href="SystemT.html#6746" class="Bound">T</a>
       <a id="6778" class="Symbol">→</a> <a id="6780" href="SystemT.html#6736" class="Bound">Γ</a> <a id="6782" href="SystemT.html#6327" class="Datatype Operator">⊩ᵨ</a> <a id="6785" href="SystemT.html#6738" class="Bound">Δ</a>
         <a id="6796" class="Comment">------</a>
       <a id="6810" class="Symbol">→</a> <a id="6812" href="SystemT.html#6736" class="Bound">Γ</a> <a id="6814" href="SystemT.html#2683" class="Datatype Operator">∋</a> <a id="6816" href="SystemT.html#6746" class="Bound">T</a>
<a id="6818" href="SystemT.html#6724" class="Function">rename</a> <a id="6825" href="SystemT.html#2712" class="InductiveConstructor">`Z</a> <a id="6828" class="Symbol">(</a><a id="6829" href="SystemT.html#6829" class="Bound">σᵨ</a> <a id="6832" href="SystemT.html#6380" class="InductiveConstructor Operator">,</a> <a id="6834" href="SystemT.html#6834" class="Bound">x</a><a id="6835" class="Symbol">)</a> <a id="6837" class="Symbol">=</a> <a id="6839" href="SystemT.html#6834" class="Bound">x</a>
<a id="6841" href="SystemT.html#6724" class="Function">rename</a> <a id="6848" class="Symbol">(</a><a id="6849" href="SystemT.html#2777" class="InductiveConstructor Operator">`S</a> <a id="6852" href="SystemT.html#6852" class="Bound">x</a><a id="6853" class="Symbol">)</a> <a id="6855" class="Symbol">(</a><a id="6856" href="SystemT.html#6856" class="Bound">σᵨ</a> <a id="6859" href="SystemT.html#6380" class="InductiveConstructor Operator">,</a> <a id="6861" class="Symbol">_)</a> <a id="6864" class="Symbol">=</a> <a id="6866" href="SystemT.html#6724" class="Function">rename</a> <a id="6873" href="SystemT.html#6852" class="Bound">x</a> <a id="6875" href="SystemT.html#6856" class="Bound">σᵨ</a>
</pre>
<p>We define parallel substitutions and renaming substitutions with the
previous rules so that we can define a shifting operation over them.
Shifting a renaming substitution shifts all indices in the renaming by
one – in other words, given a renaming between Γ and Δ, we can create a
renaming between Γ , T and Δ.</p>
We will use this to extend a renaming under a binder.
<pre class="Agda"><a id="_↑ᵨ"></a><a id="7258" href="SystemT.html#7258" class="Function Operator">_↑ᵨ</a> <a id="7262" class="Symbol">:</a> <a id="7264" class="Symbol">∀</a> <a id="7266" class="Symbol">{</a><a id="7267" href="SystemT.html#7267" class="Bound">Γ</a> <a id="7269" href="SystemT.html#7269" class="Bound">Δ</a> <a id="7271" class="Symbol">:</a> <a id="7273" href="SystemT.html#1272" class="Datatype">Γ</a><a id="7274" class="Symbol">}</a> <a id="7276" class="Symbol">{</a><a id="7277" href="SystemT.html#7277" class="Bound">T</a> <a id="7279" class="Symbol">:</a> <a id="7281" href="SystemT.html#561" class="Datatype">Type</a><a id="7285" class="Symbol">}</a>
    <a id="7291" class="Symbol">→</a> <a id="7293" href="SystemT.html#7267" class="Bound">Γ</a> <a id="7295" href="SystemT.html#6327" class="Datatype Operator">⊩ᵨ</a> <a id="7298" href="SystemT.html#7269" class="Bound">Δ</a>
      <a id="7306" class="Comment">------------</a>
    <a id="7323" class="Symbol">→</a> <a id="7325" class="Symbol">(</a><a id="7326" href="SystemT.html#7267" class="Bound">Γ</a> <a id="7328" class="InductiveConstructor Operator">,</a> <a id="7330" href="SystemT.html#7277" class="Bound">T</a><a id="7331" class="Symbol">)</a> <a id="7333" href="SystemT.html#6327" class="Datatype Operator">⊩ᵨ</a> <a id="7336" href="SystemT.html#7269" class="Bound">Δ</a>
<a id="7338" href="SystemT.html#6354" class="InductiveConstructor">∅</a> <a id="7340" href="SystemT.html#7258" class="Function Operator">↑ᵨ</a> <a id="7343" class="Symbol">=</a> <a id="7345" href="SystemT.html#6354" class="InductiveConstructor">∅</a>
<a id="7347" class="Symbol">(</a><a id="7348" href="SystemT.html#7348" class="Bound">σᵨ</a> <a id="7351" href="SystemT.html#6380" class="InductiveConstructor Operator">,</a> <a id="7353" href="SystemT.html#7353" class="Bound">x</a><a id="7354" class="Symbol">)</a> <a id="7356" href="SystemT.html#7258" class="Function Operator">↑ᵨ</a> <a id="7359" class="Symbol">=</a> <a id="7361" href="SystemT.html#7348" class="Bound">σᵨ</a> <a id="7364" href="SystemT.html#7258" class="Function Operator">↑ᵨ</a> <a id="7367" href="SystemT.html#6380" class="InductiveConstructor Operator">,</a> <a id="7369" href="SystemT.html#2777" class="InductiveConstructor Operator">`S</a> <a id="7372" href="SystemT.html#7353" class="Bound">x</a>

<a id="7375" class="Keyword">infix</a> <a id="7381" class="Number">6</a> <a id="7383" href="SystemT.html#7258" class="Function Operator">_↑ᵨ</a>
</pre>
With this operation in place, we can define the application of a
renaming substitution to rebase a term from a context Δ to a context Γ,
this is done by using the renaming substitution to replace all variables
used in the term by their corresponding variables in Γ
<pre class="Agda"><a id="_[_]ᵨ"></a><a id="7665" href="SystemT.html#7665" class="Function Operator">_[_]ᵨ</a> <a id="7671" class="Symbol">:</a> <a id="7673" class="Symbol">∀</a> <a id="7675" class="Symbol">{</a><a id="7676" href="SystemT.html#7676" class="Bound">Γ</a> <a id="7678" href="SystemT.html#7678" class="Bound">Δ</a> <a id="7680" class="Symbol">:</a> <a id="7682" href="SystemT.html#1272" class="Datatype">Γ</a><a id="7683" class="Symbol">}</a> <a id="7685" class="Symbol">{</a><a id="7686" href="SystemT.html#7686" class="Bound">T</a> <a id="7688" class="Symbol">:</a> <a id="7690" href="SystemT.html#561" class="Datatype">Type</a><a id="7694" class="Symbol">}</a>
        <a id="7704" class="Symbol">→</a> <a id="7706" href="SystemT.html#7678" class="Bound">Δ</a> <a id="7708" href="SystemT.html#3345" class="Datatype Operator">⊢</a> <a id="7710" href="SystemT.html#7686" class="Bound">T</a>
        <a id="7720" class="Symbol">→</a> <a id="7722" href="SystemT.html#7676" class="Bound">Γ</a> <a id="7724" href="SystemT.html#6327" class="Datatype Operator">⊩ᵨ</a> <a id="7727" href="SystemT.html#7678" class="Bound">Δ</a>
          <a id="7739" class="Comment">------</a>
        <a id="7754" class="Symbol">→</a> <a id="7756" href="SystemT.html#7676" class="Bound">Γ</a> <a id="7758" href="SystemT.html#3345" class="Datatype Operator">⊢</a> <a id="7760" href="SystemT.html#7686" class="Bound">T</a>
<a id="7762" href="SystemT.html#3378" class="InductiveConstructor">zero</a> <a id="7767" href="SystemT.html#7665" class="Function Operator">[</a> <a id="7769" class="Symbol">_</a> <a id="7771" href="SystemT.html#7665" class="Function Operator">]ᵨ</a> <a id="7774" class="Symbol">=</a> <a id="7776" href="SystemT.html#3378" class="InductiveConstructor">zero</a>
<a id="7781" href="SystemT.html#3396" class="InductiveConstructor">suc</a> <a id="7785" href="SystemT.html#7665" class="Function Operator">[</a> <a id="7787" class="Symbol">_</a> <a id="7789" href="SystemT.html#7665" class="Function Operator">]ᵨ</a> <a id="7792" class="Symbol">=</a> <a id="7794" href="SystemT.html#3396" class="InductiveConstructor">suc</a>
<a id="7798" href="SystemT.html#3419" class="InductiveConstructor">rec</a> <a id="7802" href="SystemT.html#7665" class="Function Operator">[</a> <a id="7804" class="Symbol">_</a> <a id="7806" href="SystemT.html#7665" class="Function Operator">]ᵨ</a> <a id="7809" class="Symbol">=</a> <a id="7811" href="SystemT.html#3419" class="InductiveConstructor">rec</a>
<a id="7815" class="Symbol">(</a><a id="7816" href="SystemT.html#3528" class="InductiveConstructor Operator">`</a> <a id="7818" href="SystemT.html#2712" class="InductiveConstructor">`Z</a><a id="7820" class="Symbol">)</a> <a id="7822" href="SystemT.html#7665" class="Function Operator">[</a> <a id="7824" class="Symbol">_</a> <a id="7826" href="SystemT.html#6380" class="InductiveConstructor Operator">,</a> <a id="7828" href="SystemT.html#7828" class="Bound">x</a> <a id="7830" href="SystemT.html#7665" class="Function Operator">]ᵨ</a> <a id="7833" class="Symbol">=</a> <a id="7835" href="SystemT.html#3528" class="InductiveConstructor Operator">`</a> <a id="7837" href="SystemT.html#7828" class="Bound">x</a>
<a id="7839" class="Symbol">(</a><a id="7840" href="SystemT.html#3528" class="InductiveConstructor Operator">`</a> <a id="7842" class="Symbol">(</a><a id="7843" href="SystemT.html#2777" class="InductiveConstructor Operator">`S</a> <a id="7846" href="SystemT.html#7846" class="Bound">x</a><a id="7847" class="Symbol">))</a> <a id="7850" href="SystemT.html#7665" class="Function Operator">[</a> <a id="7852" href="SystemT.html#7852" class="Bound">σᵨ</a> <a id="7855" href="SystemT.html#6380" class="InductiveConstructor Operator">,</a> <a id="7857" class="Symbol">_</a> <a id="7859" href="SystemT.html#7665" class="Function Operator">]ᵨ</a> <a id="7862" class="Symbol">=</a> <a id="7864" class="Symbol">(</a><a id="7865" href="SystemT.html#3528" class="InductiveConstructor Operator">`</a> <a id="7867" href="SystemT.html#7846" class="Bound">x</a><a id="7868" class="Symbol">)</a> <a id="7870" href="SystemT.html#7665" class="Function Operator">[</a> <a id="7872" href="SystemT.html#7852" class="Bound">σᵨ</a> <a id="7875" href="SystemT.html#7665" class="Function Operator">]ᵨ</a>
<a id="7878" class="Symbol">(</a><a id="7879" href="SystemT.html#3588" class="InductiveConstructor Operator">ƛ</a> <a id="7881" href="SystemT.html#7881" class="Bound">t</a><a id="7882" class="Symbol">)</a> <a id="7884" href="SystemT.html#7665" class="Function Operator">[</a> <a id="7886" href="SystemT.html#7886" class="Bound">σᵨ</a> <a id="7889" href="SystemT.html#7665" class="Function Operator">]ᵨ</a> <a id="7892" class="Symbol">=</a> <a id="7894" href="SystemT.html#3588" class="InductiveConstructor Operator">ƛ</a> <a id="7896" href="SystemT.html#7881" class="Bound">t</a> <a id="7898" href="SystemT.html#7665" class="Function Operator">[</a> <a id="7900" href="SystemT.html#7886" class="Bound">σᵨ</a> <a id="7903" href="SystemT.html#7258" class="Function Operator">↑ᵨ</a> <a id="7906" href="SystemT.html#6380" class="InductiveConstructor Operator">,</a> <a id="7908" href="SystemT.html#2712" class="InductiveConstructor">`Z</a> <a id="7911" href="SystemT.html#7665" class="Function Operator">]ᵨ</a>
<a id="7914" class="Symbol">(</a><a id="7915" href="SystemT.html#7915" class="Bound">r</a> <a id="7917" href="SystemT.html#3662" class="InductiveConstructor Operator">·</a> <a id="7919" href="SystemT.html#7919" class="Bound">s</a><a id="7920" class="Symbol">)</a> <a id="7922" href="SystemT.html#7665" class="Function Operator">[</a> <a id="7924" href="SystemT.html#7924" class="Bound">σᵨ</a> <a id="7927" href="SystemT.html#7665" class="Function Operator">]ᵨ</a> <a id="7930" class="Symbol">=</a> <a id="7932" href="SystemT.html#7915" class="Bound">r</a> <a id="7934" href="SystemT.html#7665" class="Function Operator">[</a> <a id="7936" href="SystemT.html#7924" class="Bound">σᵨ</a> <a id="7939" href="SystemT.html#7665" class="Function Operator">]ᵨ</a> <a id="7942" href="SystemT.html#3662" class="InductiveConstructor Operator">·</a> <a id="7944" href="SystemT.html#7919" class="Bound">s</a> <a id="7946" href="SystemT.html#7665" class="Function Operator">[</a> <a id="7948" href="SystemT.html#7924" class="Bound">σᵨ</a> <a id="7951" href="SystemT.html#7665" class="Function Operator">]ᵨ</a>

<a id="7955" class="Keyword">infix</a> <a id="7961" class="Number">8</a> <a id="7963" href="SystemT.html#7665" class="Function Operator">_[_]ᵨ</a>
</pre>
<p>We also define a few “primitive” renamings that will be convenient
for general substitutions:</p>
<p>The identity and incrementing renaming, defined mutually. The
identity renaming leaves all variables unchanged, while the incrementing
renaming increments all variables (which are really just indices) by
1</p>
<pre class="Agda"><a id="idᵨ"></a><a id="8284" href="SystemT.html#8284" class="Function">idᵨ</a> <a id="8288" class="Symbol">:</a> <a id="8290" class="Symbol">∀</a> <a id="8292" class="Symbol">{</a><a id="8293" href="SystemT.html#8293" class="Bound">Γ</a> <a id="8295" class="Symbol">:</a> <a id="8297" href="SystemT.html#1272" class="Datatype">Γ</a><a id="8298" class="Symbol">}</a> <a id="8300" class="Symbol">→</a> <a id="8302" href="SystemT.html#8293" class="Bound">Γ</a> <a id="8304" href="SystemT.html#6327" class="Datatype Operator">⊩ᵨ</a> <a id="8307" href="SystemT.html#8293" class="Bound">Γ</a>
<a id="incrᵨ"></a><a id="8309" href="SystemT.html#8309" class="Function">incrᵨ</a> <a id="8315" class="Symbol">:</a> <a id="8317" class="Symbol">∀</a> <a id="8319" class="Symbol">{</a><a id="8320" href="SystemT.html#8320" class="Bound">Γ</a> <a id="8322" class="Symbol">:</a> <a id="8324" href="SystemT.html#1272" class="Datatype">Γ</a><a id="8325" class="Symbol">}</a> <a id="8327" class="Symbol">{</a><a id="8328" href="SystemT.html#8328" class="Bound">T</a> <a id="8330" class="Symbol">:</a> <a id="8332" href="SystemT.html#561" class="Datatype">Type</a><a id="8336" class="Symbol">}</a> <a id="8338" class="Symbol">→</a> <a id="8340" class="Symbol">(</a><a id="8341" href="SystemT.html#8320" class="Bound">Γ</a> <a id="8343" class="InductiveConstructor Operator">,</a> <a id="8345" href="SystemT.html#8328" class="Bound">T</a><a id="8346" class="Symbol">)</a> <a id="8348" href="SystemT.html#6327" class="Datatype Operator">⊩ᵨ</a> <a id="8351" href="SystemT.html#8320" class="Bound">Γ</a>

<a id="8354" href="SystemT.html#8284" class="Function">idᵨ</a> <a id="8358" class="Symbol">{</a><a id="8359" href="SystemT.html#1288" class="InductiveConstructor">∅</a><a id="8360" class="Symbol">}</a> <a id="8362" class="Symbol">=</a> <a id="8364" href="SystemT.html#6354" class="InductiveConstructor">∅</a>
<a id="8366" href="SystemT.html#8284" class="Function">idᵨ</a> <a id="8370" class="Symbol">{</a><a id="8371" href="SystemT.html#8371" class="Bound">Γ</a> <a id="8373" href="SystemT.html#1296" class="InductiveConstructor Operator">,</a> <a id="8375" href="SystemT.html#8375" class="Bound">T</a><a id="8376" class="Symbol">}</a> <a id="8378" class="Symbol">=</a> <a id="8380" href="SystemT.html#8309" class="Function">incrᵨ</a> <a id="8386" href="SystemT.html#6380" class="InductiveConstructor Operator">,</a> <a id="8388" href="SystemT.html#2712" class="InductiveConstructor">`Z</a>

<a id="8392" href="SystemT.html#8309" class="Function">incrᵨ</a> <a id="8398" class="Symbol">=</a> <a id="8400" href="SystemT.html#8284" class="Function">idᵨ</a> <a id="8404" href="SystemT.html#7258" class="Function Operator">↑ᵨ</a>
</pre>
<p>A renaming between a context Γ′ and Γ, where Γ′ is an extension of Γ.
This renaming is really a series of shifts based on how many extensions
to Γ the context Γ′ contains.</p>
<pre class="Agda"><a id="≤ᵨ"></a><a id="8593" href="SystemT.html#8593" class="Function">≤ᵨ</a> <a id="8596" class="Symbol">:</a> <a id="8598" class="Symbol">∀</a> <a id="8600" class="Symbol">{</a><a id="8601" href="SystemT.html#8601" class="Bound">Γ′</a> <a id="8604" href="SystemT.html#8604" class="Bound">Γ</a> <a id="8606" class="Symbol">:</a> <a id="8608" href="SystemT.html#1272" class="Datatype">Γ</a><a id="8609" class="Symbol">}</a> <a id="8611" class="Symbol">→</a> <a id="8613" href="SystemT.html#8601" class="Bound">Γ′</a> <a id="8616" href="SystemT.html#2018" class="Datatype Operator">≤</a> <a id="8618" href="SystemT.html#8604" class="Bound">Γ</a> <a id="8620" class="Symbol">→</a> <a id="8622" href="SystemT.html#8601" class="Bound">Γ′</a> <a id="8625" href="SystemT.html#6327" class="Datatype Operator">⊩ᵨ</a> <a id="8628" href="SystemT.html#8604" class="Bound">Γ</a>
<a id="8630" href="SystemT.html#8593" class="Function">≤ᵨ</a> <a id="8633" href="SystemT.html#2044" class="InductiveConstructor">≤-id</a> <a id="8638" class="Symbol">=</a> <a id="8640" href="SystemT.html#8284" class="Function">idᵨ</a>
<a id="8644" href="SystemT.html#8593" class="Function">≤ᵨ</a> <a id="8647" class="Symbol">(</a><a id="8648" href="SystemT.html#2072" class="InductiveConstructor">≤-ext</a> <a id="8654" href="SystemT.html#8654" class="Bound">pf</a><a id="8656" class="Symbol">)</a> <a id="8658" class="Symbol">=</a> <a id="8660" class="Symbol">(</a><a id="8661" href="SystemT.html#8593" class="Function">≤ᵨ</a> <a id="8664" href="SystemT.html#8654" class="Bound">pf</a><a id="8666" class="Symbol">)</a> <a id="8668" href="SystemT.html#7258" class="Function Operator">↑ᵨ</a>
</pre>
Since a renaming is really just a specialized substitution, we can
transform any renaming substitution into a parallel substitution
<pre class="Agda"><a id="substᵨ"></a><a id="8816" href="SystemT.html#8816" class="Function">substᵨ</a> <a id="8823" class="Symbol">:</a> <a id="8825" class="Symbol">∀</a> <a id="8827" class="Symbol">{</a><a id="8828" href="SystemT.html#8828" class="Bound">Γ</a> <a id="8830" href="SystemT.html#8830" class="Bound">Δ</a> <a id="8832" class="Symbol">:</a> <a id="8834" href="SystemT.html#1272" class="Datatype">Γ</a><a id="8835" class="Symbol">}</a> <a id="8837" class="Symbol">→</a> <a id="8839" href="SystemT.html#8828" class="Bound">Γ</a> <a id="8841" href="SystemT.html#6327" class="Datatype Operator">⊩ᵨ</a> <a id="8844" href="SystemT.html#8830" class="Bound">Δ</a> <a id="8846" class="Symbol">→</a> <a id="8848" href="SystemT.html#8828" class="Bound">Γ</a> <a id="8850" href="SystemT.html#5683" class="Datatype Operator">⊩</a> <a id="8852" href="SystemT.html#8830" class="Bound">Δ</a>
<a id="8854" href="SystemT.html#8816" class="Function">substᵨ</a> <a id="8861" href="SystemT.html#6354" class="InductiveConstructor">∅</a> <a id="8863" class="Symbol">=</a> <a id="8865" href="SystemT.html#5709" class="InductiveConstructor">∅</a>
<a id="8867" href="SystemT.html#8816" class="Function">substᵨ</a> <a id="8874" class="Symbol">(</a><a id="8875" href="SystemT.html#8875" class="Bound">σᵨ</a> <a id="8878" href="SystemT.html#6380" class="InductiveConstructor Operator">,</a> <a id="8880" href="SystemT.html#8880" class="Bound">x</a><a id="8881" class="Symbol">)</a> <a id="8883" class="Symbol">=</a> <a id="8885" href="SystemT.html#8816" class="Function">substᵨ</a> <a id="8892" href="SystemT.html#8875" class="Bound">σᵨ</a> <a id="8895" href="SystemT.html#5730" class="InductiveConstructor Operator">,</a> <a id="8897" href="SystemT.html#3528" class="InductiveConstructor Operator">`</a> <a id="8899" href="SystemT.html#8880" class="Bound">x</a>
</pre>
<p>We can now use our renaming substitutions to build out parallel
substitutions and their operations, such that their operations are
guaranteed to terminate.</p>
Similarly as for renaming substitutions, we define a shifting operation
for parallel substitutions, to be used for extending a substitution
under a binder.
<pre class="Agda"><a id="_↑"></a><a id="9227" href="SystemT.html#9227" class="Function Operator">_↑</a> <a id="9230" class="Symbol">:</a> <a id="9232" class="Symbol">∀</a> <a id="9234" class="Symbol">{</a><a id="9235" href="SystemT.html#9235" class="Bound">Γ</a> <a id="9237" href="SystemT.html#9237" class="Bound">Δ</a> <a id="9239" class="Symbol">:</a> <a id="9241" href="SystemT.html#1272" class="Datatype">Γ</a><a id="9242" class="Symbol">}</a> <a id="9244" class="Symbol">{</a><a id="9245" href="SystemT.html#9245" class="Bound">T</a> <a id="9247" class="Symbol">:</a> <a id="9249" href="SystemT.html#561" class="Datatype">Type</a><a id="9253" class="Symbol">}</a>
      <a id="9261" class="Symbol">→</a> <a id="9263" href="SystemT.html#9235" class="Bound">Γ</a> <a id="9265" href="SystemT.html#5683" class="Datatype Operator">⊩</a> <a id="9267" href="SystemT.html#9237" class="Bound">Δ</a>
        <a id="9277" class="Comment">---------</a>
      <a id="9293" class="Symbol">→</a> <a id="9295" href="SystemT.html#9235" class="Bound">Γ</a> <a id="9297" class="InductiveConstructor Operator">,</a> <a id="9299" href="SystemT.html#9245" class="Bound">T</a> <a id="9301" href="SystemT.html#5683" class="Datatype Operator">⊩</a> <a id="9303" href="SystemT.html#9237" class="Bound">Δ</a>
<a id="9305" href="SystemT.html#9227" class="Function Operator">_↑</a> <a id="9308" href="SystemT.html#5709" class="InductiveConstructor">∅</a> <a id="9310" class="Symbol">=</a> <a id="9312" href="SystemT.html#5709" class="InductiveConstructor">∅</a>
<a id="9314" href="SystemT.html#9227" class="Function Operator">_↑</a> <a id="9317" class="Symbol">(</a><a id="9318" href="SystemT.html#9318" class="Bound">σ</a> <a id="9320" href="SystemT.html#5730" class="InductiveConstructor Operator">,</a> <a id="9322" href="SystemT.html#9322" class="Bound">s</a><a id="9323" class="Symbol">)</a> <a id="9325" class="Symbol">=</a> <a id="9327" class="Symbol">(</a><a id="9328" href="SystemT.html#9318" class="Bound">σ</a> <a id="9330" href="SystemT.html#9227" class="Function Operator">↑</a><a id="9331" class="Symbol">)</a> <a id="9333" href="SystemT.html#5730" class="InductiveConstructor Operator">,</a> <a id="9335" href="SystemT.html#9322" class="Bound">s</a> <a id="9337" href="SystemT.html#7665" class="Function Operator">[</a> <a id="9339" href="SystemT.html#8309" class="Function">incrᵨ</a> <a id="9345" href="SystemT.html#7665" class="Function Operator">]ᵨ</a>

<a id="9349" class="Keyword">infix</a> <a id="9355" class="Number">6</a> <a id="9357" href="SystemT.html#9227" class="Function Operator">_↑</a>
</pre>
Now, we can define the application of a parallel substitution
<code>Γ ⊢ σ : Δ</code> to a term <code>Δ ⊢ t : T</code>
(e.g. <code>t [ σ ]</code>)
<pre class="Agda"><a id="_[_]"></a><a id="9486" href="SystemT.html#9486" class="Function Operator">_[_]</a> <a id="9491" class="Symbol">:</a> <a id="9493" class="Symbol">∀</a> <a id="9495" class="Symbol">{</a><a id="9496" href="SystemT.html#9496" class="Bound">Γ</a> <a id="9498" href="SystemT.html#9498" class="Bound">Δ</a> <a id="9500" class="Symbol">:</a> <a id="9502" href="SystemT.html#1272" class="Datatype">Γ</a><a id="9503" class="Symbol">}</a> <a id="9505" class="Symbol">{</a><a id="9506" href="SystemT.html#9506" class="Bound">T</a> <a id="9508" class="Symbol">:</a> <a id="9510" href="SystemT.html#561" class="Datatype">Type</a><a id="9514" class="Symbol">}</a>
     <a id="9521" class="Symbol">→</a> <a id="9523" href="SystemT.html#9498" class="Bound">Δ</a> <a id="9525" href="SystemT.html#3345" class="Datatype Operator">⊢</a> <a id="9527" href="SystemT.html#9506" class="Bound">T</a>
     <a id="9534" class="Symbol">→</a> <a id="9536" href="SystemT.html#9496" class="Bound">Γ</a> <a id="9538" href="SystemT.html#5683" class="Datatype Operator">⊩</a> <a id="9540" href="SystemT.html#9498" class="Bound">Δ</a>
       <a id="9549" class="Comment">-----</a>
     <a id="9560" class="Symbol">→</a> <a id="9562" href="SystemT.html#9496" class="Bound">Γ</a> <a id="9564" href="SystemT.html#3345" class="Datatype Operator">⊢</a> <a id="9566" href="SystemT.html#9506" class="Bound">T</a>
<a id="9568" href="SystemT.html#3378" class="InductiveConstructor">zero</a> <a id="9573" href="SystemT.html#9486" class="Function Operator">[</a> <a id="9575" href="SystemT.html#9575" class="Bound">σ</a> <a id="9577" href="SystemT.html#9486" class="Function Operator">]</a> <a id="9579" class="Symbol">=</a> <a id="9581" href="SystemT.html#3378" class="InductiveConstructor">zero</a>
<a id="9586" href="SystemT.html#3396" class="InductiveConstructor">suc</a> <a id="9590" href="SystemT.html#9486" class="Function Operator">[</a> <a id="9592" href="SystemT.html#9592" class="Bound">σ</a> <a id="9594" href="SystemT.html#9486" class="Function Operator">]</a> <a id="9596" class="Symbol">=</a> <a id="9598" href="SystemT.html#3396" class="InductiveConstructor">suc</a>
<a id="9602" href="SystemT.html#3419" class="InductiveConstructor">rec</a> <a id="9606" href="SystemT.html#9486" class="Function Operator">[</a> <a id="9608" href="SystemT.html#9608" class="Bound">σ</a> <a id="9610" href="SystemT.html#9486" class="Function Operator">]</a> <a id="9612" class="Symbol">=</a> <a id="9614" href="SystemT.html#3419" class="InductiveConstructor">rec</a>
<a id="9618" class="Symbol">(</a><a id="9619" href="SystemT.html#3528" class="InductiveConstructor Operator">`</a> <a id="9621" href="SystemT.html#2712" class="InductiveConstructor">`Z</a><a id="9623" class="Symbol">)</a> <a id="9625" href="SystemT.html#9486" class="Function Operator">[</a> <a id="9627" class="Symbol">_</a> <a id="9629" href="SystemT.html#5730" class="InductiveConstructor Operator">,</a> <a id="9631" href="SystemT.html#9631" class="Bound">x</a> <a id="9633" href="SystemT.html#9486" class="Function Operator">]</a> <a id="9635" class="Symbol">=</a> <a id="9637" href="SystemT.html#9631" class="Bound">x</a>
<a id="9639" class="Symbol">(</a><a id="9640" href="SystemT.html#3528" class="InductiveConstructor Operator">`</a> <a id="9642" class="Symbol">(</a><a id="9643" href="SystemT.html#2777" class="InductiveConstructor Operator">`S</a> <a id="9646" href="SystemT.html#9646" class="Bound">x</a><a id="9647" class="Symbol">))</a> <a id="9650" href="SystemT.html#9486" class="Function Operator">[</a> <a id="9652" href="SystemT.html#9652" class="Bound">σ</a> <a id="9654" href="SystemT.html#5730" class="InductiveConstructor Operator">,</a> <a id="9656" class="Symbol">_</a> <a id="9658" href="SystemT.html#9486" class="Function Operator">]</a> <a id="9660" class="Symbol">=</a> <a id="9662" href="SystemT.html#3528" class="InductiveConstructor Operator">`</a> <a id="9664" href="SystemT.html#9646" class="Bound">x</a> <a id="9666" href="SystemT.html#9486" class="Function Operator">[</a> <a id="9668" href="SystemT.html#9652" class="Bound">σ</a> <a id="9670" href="SystemT.html#9486" class="Function Operator">]</a>
<a id="9672" class="Symbol">(</a><a id="9673" href="SystemT.html#3588" class="InductiveConstructor Operator">ƛ</a> <a id="9675" href="SystemT.html#9675" class="Bound">t</a><a id="9676" class="Symbol">)</a> <a id="9678" href="SystemT.html#9486" class="Function Operator">[</a> <a id="9680" href="SystemT.html#9680" class="Bound">σ</a> <a id="9682" href="SystemT.html#9486" class="Function Operator">]</a> <a id="9684" class="Symbol">=</a> <a id="9686" href="SystemT.html#3588" class="InductiveConstructor Operator">ƛ</a> <a id="9688" class="Symbol">(</a><a id="9689" href="SystemT.html#9675" class="Bound">t</a> <a id="9691" href="SystemT.html#9486" class="Function Operator">[</a> <a id="9693" href="SystemT.html#9680" class="Bound">σ</a> <a id="9695" href="SystemT.html#9227" class="Function Operator">↑</a> <a id="9697" href="SystemT.html#5730" class="InductiveConstructor Operator">,</a> <a id="9699" href="SystemT.html#3528" class="InductiveConstructor Operator">`</a> <a id="9701" href="SystemT.html#2712" class="InductiveConstructor">`Z</a> <a id="9704" href="SystemT.html#9486" class="Function Operator">]</a><a id="9705" class="Symbol">)</a>
<a id="9707" class="Symbol">(</a><a id="9708" href="SystemT.html#9708" class="Bound">r</a> <a id="9710" href="SystemT.html#3662" class="InductiveConstructor Operator">·</a> <a id="9712" href="SystemT.html#9712" class="Bound">s</a><a id="9713" class="Symbol">)</a> <a id="9715" href="SystemT.html#9486" class="Function Operator">[</a> <a id="9717" href="SystemT.html#9717" class="Bound">σ</a> <a id="9719" href="SystemT.html#9486" class="Function Operator">]</a> <a id="9721" class="Symbol">=</a> <a id="9723" href="SystemT.html#9708" class="Bound">r</a> <a id="9725" href="SystemT.html#9486" class="Function Operator">[</a> <a id="9727" href="SystemT.html#9717" class="Bound">σ</a> <a id="9729" href="SystemT.html#9486" class="Function Operator">]</a> <a id="9731" href="SystemT.html#3662" class="InductiveConstructor Operator">·</a> <a id="9733" href="SystemT.html#9712" class="Bound">s</a> <a id="9735" href="SystemT.html#9486" class="Function Operator">[</a> <a id="9737" href="SystemT.html#9717" class="Bound">σ</a> <a id="9739" href="SystemT.html#9486" class="Function Operator">]</a>

<a id="9742" class="Keyword">infix</a> <a id="9748" class="Number">8</a> <a id="9750" href="SystemT.html#9486" class="Function Operator">_[_]</a>
</pre>
Substitutions can also be composed, by applying a substitution
<code>Γ₁ ⊢ τ : Γ₂</code> to every term in a substitution
<code>Γ₂ ⊢ σ : Γ₃</code>
<pre class="Agda"><a id="_∘_"></a><a id="9891" href="SystemT.html#9891" class="Function Operator">_∘_</a> <a id="9895" class="Symbol">:</a> <a id="9897" class="Symbol">∀</a> <a id="9899" class="Symbol">{</a><a id="9900" href="SystemT.html#9900" class="Bound">Γ₁</a> <a id="9903" href="SystemT.html#9903" class="Bound">Γ₂</a> <a id="9906" href="SystemT.html#9906" class="Bound">Γ₃</a> <a id="9909" class="Symbol">:</a> <a id="9911" href="SystemT.html#1272" class="Datatype">Γ</a><a id="9912" class="Symbol">}</a> <a id="9914" class="Symbol">→</a> <a id="9916" href="SystemT.html#9903" class="Bound">Γ₂</a> <a id="9919" href="SystemT.html#5683" class="Datatype Operator">⊩</a> <a id="9921" href="SystemT.html#9906" class="Bound">Γ₃</a> <a id="9924" class="Symbol">→</a> <a id="9926" href="SystemT.html#9900" class="Bound">Γ₁</a> <a id="9929" href="SystemT.html#5683" class="Datatype Operator">⊩</a> <a id="9931" href="SystemT.html#9903" class="Bound">Γ₂</a> <a id="9934" class="Symbol">→</a> <a id="9936" href="SystemT.html#9900" class="Bound">Γ₁</a> <a id="9939" href="SystemT.html#5683" class="Datatype Operator">⊩</a> <a id="9941" href="SystemT.html#9906" class="Bound">Γ₃</a>
<a id="9944" href="SystemT.html#5709" class="InductiveConstructor">∅</a> <a id="9946" href="SystemT.html#9891" class="Function Operator">∘</a> <a id="9948" class="Symbol">_</a> <a id="9950" class="Symbol">=</a> <a id="9952" href="SystemT.html#5709" class="InductiveConstructor">∅</a>
<a id="9954" class="Symbol">(</a><a id="9955" href="SystemT.html#9955" class="Bound">σ</a> <a id="9957" href="SystemT.html#5730" class="InductiveConstructor Operator">,</a> <a id="9959" href="SystemT.html#9959" class="Bound">s</a><a id="9960" class="Symbol">)</a> <a id="9962" href="SystemT.html#9891" class="Function Operator">∘</a> <a id="9964" href="SystemT.html#9964" class="Bound">τ</a> <a id="9966" class="Symbol">=</a> <a id="9968" class="Symbol">(</a><a id="9969" href="SystemT.html#9955" class="Bound">σ</a> <a id="9971" href="SystemT.html#9891" class="Function Operator">∘</a> <a id="9973" href="SystemT.html#9964" class="Bound">τ</a><a id="9974" class="Symbol">)</a> <a id="9976" href="SystemT.html#5730" class="InductiveConstructor Operator">,</a> <a id="9978" href="SystemT.html#9959" class="Bound">s</a> <a id="9980" href="SystemT.html#9486" class="Function Operator">[</a> <a id="9982" href="SystemT.html#9964" class="Bound">τ</a> <a id="9984" href="SystemT.html#9486" class="Function Operator">]</a>
</pre>
<p>We will want a weakening substitution, that allows us to weaken a
well typed term in Γ to a context Γ′ that extends Γ.</p>
Really, this substitution is the renaming substitution between extended
contexts
<pre class="Agda"><a id="weaken"></a><a id="10200" href="SystemT.html#10200" class="Function">weaken</a> <a id="10207" class="Symbol">:</a> <a id="10209" class="Symbol">∀</a> <a id="10211" class="Symbol">{</a><a id="10212" href="SystemT.html#10212" class="Bound">Γ′</a> <a id="10215" href="SystemT.html#10215" class="Bound">Γ</a> <a id="10217" class="Symbol">:</a> <a id="10219" href="SystemT.html#1272" class="Datatype">Γ</a><a id="10220" class="Symbol">}</a>
       <a id="10229" class="Symbol">→</a> <a id="10231" href="SystemT.html#10212" class="Bound">Γ′</a> <a id="10234" href="SystemT.html#2018" class="Datatype Operator">≤</a> <a id="10236" href="SystemT.html#10215" class="Bound">Γ</a>
         <a id="10247" class="Comment">------</a>
       <a id="10261" class="Symbol">→</a> <a id="10263" href="SystemT.html#10212" class="Bound">Γ′</a> <a id="10266" href="SystemT.html#5683" class="Datatype Operator">⊩</a> <a id="10268" href="SystemT.html#10215" class="Bound">Γ</a>
<a id="10270" href="SystemT.html#10200" class="Function">weaken</a> <a id="10277" href="SystemT.html#10277" class="Bound">pf</a> <a id="10280" class="Symbol">=</a> <a id="10282" href="SystemT.html#8816" class="Function">substᵨ</a> <a id="10289" class="Symbol">(</a><a id="10290" href="SystemT.html#8593" class="Function">≤ᵨ</a> <a id="10293" href="SystemT.html#10277" class="Bound">pf</a><a id="10295" class="Symbol">)</a>
</pre>
For convenience, we will also want some shorthand for applying a
weakening substitution to a term
<pre class="Agda"><a id="_≤⊢_"></a><a id="10408" href="SystemT.html#10408" class="Function Operator">_≤⊢_</a> <a id="10413" class="Symbol">:</a> <a id="10415" class="Symbol">∀</a> <a id="10417" class="Symbol">{</a><a id="10418" href="SystemT.html#10418" class="Bound">Γ′</a> <a id="10421" href="SystemT.html#10421" class="Bound">Γ</a> <a id="10423" class="Symbol">:</a> <a id="10425" href="SystemT.html#1272" class="Datatype">Γ</a><a id="10426" class="Symbol">}</a> <a id="10428" class="Symbol">{</a><a id="10429" href="SystemT.html#10429" class="Bound">T</a> <a id="10431" class="Symbol">:</a> <a id="10433" href="SystemT.html#561" class="Datatype">Type</a><a id="10437" class="Symbol">}</a> <a id="10439" class="Symbol">→</a> <a id="10441" href="SystemT.html#10418" class="Bound">Γ′</a> <a id="10444" href="SystemT.html#2018" class="Datatype Operator">≤</a> <a id="10446" href="SystemT.html#10421" class="Bound">Γ</a> <a id="10448" class="Symbol">→</a> <a id="10450" href="SystemT.html#10421" class="Bound">Γ</a> <a id="10452" href="SystemT.html#3345" class="Datatype Operator">⊢</a> <a id="10454" href="SystemT.html#10429" class="Bound">T</a> <a id="10456" class="Symbol">→</a> <a id="10458" href="SystemT.html#10418" class="Bound">Γ′</a> <a id="10461" href="SystemT.html#3345" class="Datatype Operator">⊢</a> <a id="10463" href="SystemT.html#10429" class="Bound">T</a>
<a id="10465" href="SystemT.html#10465" class="Bound">pf</a> <a id="10468" href="SystemT.html#10408" class="Function Operator">≤⊢</a> <a id="10471" href="SystemT.html#10471" class="Bound">t</a> <a id="10473" class="Symbol">=</a> <a id="10475" href="SystemT.html#10471" class="Bound">t</a> <a id="10477" href="SystemT.html#9486" class="Function Operator">[</a> <a id="10479" href="SystemT.html#10200" class="Function">weaken</a> <a id="10486" href="SystemT.html#10465" class="Bound">pf</a> <a id="10489" href="SystemT.html#9486" class="Function Operator">]</a>

<a id="10492" class="Keyword">infixr</a> <a id="10499" class="Number">5</a> <a id="10501" href="SystemT.html#10408" class="Function Operator">_≤⊢_</a>
</pre>
Additionally, we define an identity and incrementing parallel
substitution, which are simply the identity and incrementing renaming
substitutions
<pre class="Agda"><a id="id"></a><a id="10665" href="SystemT.html#10665" class="Function">id</a> <a id="10668" class="Symbol">:</a> <a id="10670" class="Symbol">∀</a> <a id="10672" class="Symbol">{</a><a id="10673" href="SystemT.html#10673" class="Bound">Γ</a> <a id="10675" class="Symbol">:</a> <a id="10677" href="SystemT.html#1272" class="Datatype">Γ</a><a id="10678" class="Symbol">}</a> <a id="10680" class="Symbol">→</a> <a id="10682" href="SystemT.html#10673" class="Bound">Γ</a> <a id="10684" href="SystemT.html#5683" class="Datatype Operator">⊩</a> <a id="10686" href="SystemT.html#10673" class="Bound">Γ</a>
<a id="10688" href="SystemT.html#10665" class="Function">id</a> <a id="10691" class="Symbol">=</a> <a id="10693" href="SystemT.html#8816" class="Function">substᵨ</a> <a id="10700" href="SystemT.html#8284" class="Function">idᵨ</a>

<a id="incr"></a><a id="10705" href="SystemT.html#10705" class="Function">incr</a> <a id="10710" class="Symbol">:</a> <a id="10712" class="Symbol">∀</a> <a id="10714" class="Symbol">{</a><a id="10715" href="SystemT.html#10715" class="Bound">Γ</a> <a id="10717" class="Symbol">:</a> <a id="10719" href="SystemT.html#1272" class="Datatype">Γ</a><a id="10720" class="Symbol">}</a> <a id="10722" class="Symbol">{</a><a id="10723" href="SystemT.html#10723" class="Bound">T</a> <a id="10725" class="Symbol">:</a> <a id="10727" href="SystemT.html#561" class="Datatype">Type</a><a id="10731" class="Symbol">}</a> <a id="10733" class="Symbol">→</a> <a id="10735" href="SystemT.html#10715" class="Bound">Γ</a> <a id="10737" class="InductiveConstructor Operator">,</a> <a id="10739" href="SystemT.html#10723" class="Bound">T</a> <a id="10741" href="SystemT.html#5683" class="Datatype Operator">⊩</a> <a id="10743" href="SystemT.html#10715" class="Bound">Γ</a>
<a id="10745" href="SystemT.html#10705" class="Function">incr</a> <a id="10750" class="Symbol">=</a> <a id="10752" href="SystemT.html#8816" class="Function">substᵨ</a> <a id="10759" href="SystemT.html#8309" class="Function">incrᵨ</a>
</pre>
The incrementing substitution will be used to establish η-equivalence,
we will also benfit from some shorthand for its application to a term
<pre class="Agda"><a id="_↑⊢_"></a><a id="10919" href="SystemT.html#10919" class="Function Operator">_↑⊢_</a> <a id="10924" class="Symbol">:</a> <a id="10926" class="Symbol">∀</a> <a id="10928" class="Symbol">{</a><a id="10929" href="SystemT.html#10929" class="Bound">Γ</a> <a id="10931" class="Symbol">:</a> <a id="10933" href="SystemT.html#1272" class="Datatype">Γ</a><a id="10934" class="Symbol">}</a> <a id="10936" class="Symbol">{</a><a id="10937" href="SystemT.html#10937" class="Bound">T</a> <a id="10939" class="Symbol">:</a> <a id="10941" href="SystemT.html#561" class="Datatype">Type</a><a id="10945" class="Symbol">}</a> <a id="10947" class="Symbol">→</a> <a id="10949" class="Symbol">(</a><a id="10950" href="SystemT.html#10950" class="Bound">S</a> <a id="10952" class="Symbol">:</a> <a id="10954" href="SystemT.html#561" class="Datatype">Type</a><a id="10958" class="Symbol">)</a> <a id="10960" class="Symbol">→</a> <a id="10962" href="SystemT.html#10929" class="Bound">Γ</a> <a id="10964" href="SystemT.html#3345" class="Datatype Operator">⊢</a> <a id="10966" href="SystemT.html#10937" class="Bound">T</a> <a id="10968" class="Symbol">→</a> <a id="10970" href="SystemT.html#10929" class="Bound">Γ</a> <a id="10972" class="InductiveConstructor Operator">,</a> <a id="10974" href="SystemT.html#10950" class="Bound">S</a> <a id="10976" href="SystemT.html#3345" class="Datatype Operator">⊢</a> <a id="10978" href="SystemT.html#10937" class="Bound">T</a>
<a id="10980" class="Symbol">_</a> <a id="10982" href="SystemT.html#10919" class="Function Operator">↑⊢</a> <a id="10985" href="SystemT.html#10985" class="Bound">t</a> <a id="10987" class="Symbol">=</a> <a id="10989" href="SystemT.html#10985" class="Bound">t</a> <a id="10991" href="SystemT.html#9486" class="Function Operator">[</a> <a id="10993" href="SystemT.html#10705" class="Function">incr</a> <a id="10998" href="SystemT.html#9486" class="Function Operator">]</a>

<a id="11001" class="Keyword">infixr</a> <a id="11008" class="Number">5</a> <a id="11010" href="SystemT.html#10919" class="Function Operator">_↑⊢_</a>
</pre>
To establish β-equivalence, we define an operation for substituting the
first free variable in a term <code>Γ , x:S ⊢ t : T</code> with a term
<code>Γ ⊢ s : S</code> (i.e. <code>t [ s / x ]</code>), which is really
shorthand for <code>t [ id , s / x ]</code>
<pre class="Agda"><a id="_[_/x]"></a><a id="11243" href="SystemT.html#11243" class="Function Operator">_[_/x]</a> <a id="11250" class="Symbol">:</a> <a id="11252" class="Symbol">∀</a> <a id="11254" class="Symbol">{</a><a id="11255" href="SystemT.html#11255" class="Bound">Γ</a> <a id="11257" class="Symbol">:</a> <a id="11259" href="SystemT.html#1272" class="Datatype">Γ</a><a id="11260" class="Symbol">}</a> <a id="11262" class="Symbol">{</a><a id="11263" href="SystemT.html#11263" class="Bound">S</a> <a id="11265" href="SystemT.html#11265" class="Bound">T</a> <a id="11267" class="Symbol">:</a> <a id="11269" href="SystemT.html#561" class="Datatype">Type</a><a id="11273" class="Symbol">}</a>
  <a id="11277" class="Symbol">→</a> <a id="11279" href="SystemT.html#11255" class="Bound">Γ</a> <a id="11281" class="InductiveConstructor Operator">,</a> <a id="11283" href="SystemT.html#11265" class="Bound">T</a> <a id="11285" href="SystemT.html#3345" class="Datatype Operator">⊢</a> <a id="11287" href="SystemT.html#11263" class="Bound">S</a>
  <a id="11291" class="Symbol">→</a> <a id="11293" href="SystemT.html#11255" class="Bound">Γ</a> <a id="11295" href="SystemT.html#3345" class="Datatype Operator">⊢</a> <a id="11297" href="SystemT.html#11265" class="Bound">T</a>
    <a id="11303" class="Comment">---------</a>
  <a id="11315" class="Symbol">→</a> <a id="11317" href="SystemT.html#11255" class="Bound">Γ</a> <a id="11319" href="SystemT.html#3345" class="Datatype Operator">⊢</a> <a id="11321" href="SystemT.html#11263" class="Bound">S</a>
<a id="11323" href="SystemT.html#11323" class="Bound">s</a> <a id="11325" href="SystemT.html#11243" class="Function Operator">[</a> <a id="11327" href="SystemT.html#11327" class="Bound">t</a> <a id="11329" href="SystemT.html#11243" class="Function Operator">/x]</a> <a id="11333" class="Symbol">=</a>  <a id="11336" href="SystemT.html#11323" class="Bound">s</a> <a id="11338" href="SystemT.html#9486" class="Function Operator">[</a> <a id="11340" href="SystemT.html#10665" class="Function">id</a> <a id="11343" href="SystemT.html#5730" class="InductiveConstructor Operator">,</a> <a id="11345" href="SystemT.html#11327" class="Bound">t</a> <a id="11347" href="SystemT.html#9486" class="Function Operator">]</a>

<a id="11350" class="Keyword">infix</a> <a id="11356" class="Number">8</a> <a id="11358" href="SystemT.html#11243" class="Function Operator">_[_/x]</a>
</pre>
<p>With these defined, we can introduce a new relation between two
terms: definitional equality. In the thesis, this is written as
<code>Γ ⊢ t = t′ : T</code>, we will use t == t′ in Agda</p>
<p>The relation is written such that the definitional equality of two
terms implies the equality of their interpretations
(<code>Γ ⊢ t = t′ : T</code> iff <code>⟦ t ⟧ = ⟦ t′ ⟧</code>); it is the
extension of Βη-equivalence for System T suggested earlier</p>
We will use this relation to prove the soundness property of
preservation of meaning for NbE (i.e. <code>⟦ nf(t) ⟧ = ⟦ t ⟧</code>)
<pre class="Agda"><a id="11903" class="Keyword">data</a> <a id="_==_"></a><a id="11908" href="SystemT.html#11908" class="Datatype Operator">_==_</a> <a id="11913" class="Symbol">:</a> <a id="11915" class="Symbol">∀</a> <a id="11917" class="Symbol">{</a><a id="11918" href="SystemT.html#11918" class="Bound">Γ</a> <a id="11920" class="Symbol">:</a> <a id="11922" href="SystemT.html#1272" class="Datatype">Γ</a><a id="11923" class="Symbol">}</a> <a id="11925" class="Symbol">{</a><a id="11926" href="SystemT.html#11926" class="Bound">T</a> <a id="11928" class="Symbol">:</a> <a id="11930" href="SystemT.html#561" class="Datatype">Type</a><a id="11934" class="Symbol">}</a> <a id="11936" class="Symbol">→</a> <a id="11938" href="SystemT.html#11918" class="Bound">Γ</a> <a id="11940" href="SystemT.html#3345" class="Datatype Operator">⊢</a> <a id="11942" href="SystemT.html#11926" class="Bound">T</a> <a id="11944" class="Symbol">→</a> <a id="11946" href="SystemT.html#11918" class="Bound">Γ</a> <a id="11948" href="SystemT.html#3345" class="Datatype Operator">⊢</a> <a id="11950" href="SystemT.html#11926" class="Bound">T</a> <a id="11952" class="Symbol">→</a> <a id="11954" href="Agda.Primitive.html#326" class="Primitive">Set</a> <a id="11958" class="Keyword">where</a>

  <a id="11967" class="Comment">-- Computation rules</a>
  <a id="_==_.β-rec-z"></a><a id="11990" href="SystemT.html#11990" class="InductiveConstructor">β-rec-z</a> <a id="11998" class="Symbol">:</a> <a id="12000" class="Symbol">∀</a> <a id="12002" class="Symbol">{</a><a id="12003" href="SystemT.html#12003" class="Bound">Γ</a> <a id="12005" class="Symbol">:</a> <a id="12007" href="SystemT.html#1272" class="Datatype">Γ</a><a id="12008" class="Symbol">}</a> <a id="12010" class="Symbol">{</a><a id="12011" href="SystemT.html#12011" class="Bound">T</a> <a id="12013" class="Symbol">:</a> <a id="12015" href="SystemT.html#561" class="Datatype">Type</a><a id="12019" class="Symbol">}</a>
              <a id="12035" class="Symbol">{</a><a id="12036" href="SystemT.html#12036" class="Bound">z</a> <a id="12038" class="Symbol">:</a> <a id="12040" href="SystemT.html#12003" class="Bound">Γ</a> <a id="12042" href="SystemT.html#3345" class="Datatype Operator">⊢</a> <a id="12044" href="SystemT.html#12011" class="Bound">T</a><a id="12045" class="Symbol">}</a>
              <a id="12061" class="Symbol">{</a><a id="12062" href="SystemT.html#12062" class="Bound">s</a> <a id="12064" class="Symbol">:</a> <a id="12066" href="SystemT.html#12003" class="Bound">Γ</a> <a id="12068" href="SystemT.html#3345" class="Datatype Operator">⊢</a> <a id="12070" href="SystemT.html#580" class="InductiveConstructor">nat</a> <a id="12074" href="SystemT.html#593" class="InductiveConstructor Operator">⇒</a> <a id="12076" href="SystemT.html#12011" class="Bound">T</a> <a id="12078" href="SystemT.html#593" class="InductiveConstructor Operator">⇒</a> <a id="12080" href="SystemT.html#12011" class="Bound">T</a><a id="12081" class="Symbol">}</a>
              <a id="12097" class="Comment">-----------------------</a>
            <a id="12133" class="Symbol">→</a> <a id="12135" href="SystemT.html#3419" class="InductiveConstructor">rec</a> <a id="12139" href="SystemT.html#3662" class="InductiveConstructor Operator">·</a> <a id="12141" href="SystemT.html#12036" class="Bound">z</a> <a id="12143" href="SystemT.html#3662" class="InductiveConstructor Operator">·</a> <a id="12145" href="SystemT.html#12062" class="Bound">s</a> <a id="12147" href="SystemT.html#3662" class="InductiveConstructor Operator">·</a> <a id="12149" href="SystemT.html#3378" class="InductiveConstructor">zero</a> <a id="12154" href="SystemT.html#11908" class="Datatype Operator">==</a> <a id="12157" href="SystemT.html#12036" class="Bound">z</a>

  <a id="_==_.β-rec-s"></a><a id="12162" href="SystemT.html#12162" class="InductiveConstructor">β-rec-s</a> <a id="12170" class="Symbol">:</a> <a id="12172" class="Symbol">∀</a> <a id="12174" class="Symbol">{</a><a id="12175" href="SystemT.html#12175" class="Bound">Γ</a> <a id="12177" class="Symbol">:</a> <a id="12179" href="SystemT.html#1272" class="Datatype">Γ</a><a id="12180" class="Symbol">}</a> <a id="12182" class="Symbol">{</a><a id="12183" href="SystemT.html#12183" class="Bound">T</a> <a id="12185" class="Symbol">:</a> <a id="12187" href="SystemT.html#561" class="Datatype">Type</a><a id="12191" class="Symbol">}</a>
      <a id="12199" class="Symbol">{</a><a id="12200" href="SystemT.html#12200" class="Bound">z</a> <a id="12202" class="Symbol">:</a> <a id="12204" href="SystemT.html#12175" class="Bound">Γ</a> <a id="12206" href="SystemT.html#3345" class="Datatype Operator">⊢</a> <a id="12208" href="SystemT.html#12183" class="Bound">T</a><a id="12209" class="Symbol">}</a>
      <a id="12217" class="Symbol">{</a><a id="12218" href="SystemT.html#12218" class="Bound">s</a> <a id="12220" class="Symbol">:</a> <a id="12222" href="SystemT.html#12175" class="Bound">Γ</a> <a id="12224" href="SystemT.html#3345" class="Datatype Operator">⊢</a> <a id="12226" href="SystemT.html#580" class="InductiveConstructor">nat</a> <a id="12230" href="SystemT.html#593" class="InductiveConstructor Operator">⇒</a> <a id="12232" href="SystemT.html#12183" class="Bound">T</a> <a id="12234" href="SystemT.html#593" class="InductiveConstructor Operator">⇒</a> <a id="12236" href="SystemT.html#12183" class="Bound">T</a><a id="12237" class="Symbol">}</a>
      <a id="12245" class="Symbol">{</a><a id="12246" href="SystemT.html#12246" class="Bound">n</a> <a id="12248" class="Symbol">:</a> <a id="12250" href="SystemT.html#12175" class="Bound">Γ</a> <a id="12252" href="SystemT.html#3345" class="Datatype Operator">⊢</a> <a id="12254" href="SystemT.html#580" class="InductiveConstructor">nat</a><a id="12257" class="Symbol">}</a>
      <a id="12265" class="Comment">----------------------------------------------------</a>
    <a id="12322" class="Symbol">→</a> <a id="12324" href="SystemT.html#3419" class="InductiveConstructor">rec</a> <a id="12328" href="SystemT.html#3662" class="InductiveConstructor Operator">·</a> <a id="12330" href="SystemT.html#12200" class="Bound">z</a> <a id="12332" href="SystemT.html#3662" class="InductiveConstructor Operator">·</a> <a id="12334" href="SystemT.html#12218" class="Bound">s</a> <a id="12336" href="SystemT.html#3662" class="InductiveConstructor Operator">·</a> <a id="12338" class="Symbol">(</a><a id="12339" href="SystemT.html#3396" class="InductiveConstructor">suc</a> <a id="12343" href="SystemT.html#3662" class="InductiveConstructor Operator">·</a> <a id="12345" href="SystemT.html#12246" class="Bound">n</a><a id="12346" class="Symbol">)</a> <a id="12348" href="SystemT.html#11908" class="Datatype Operator">==</a> <a id="12351" href="SystemT.html#12218" class="Bound">s</a> <a id="12353" href="SystemT.html#3662" class="InductiveConstructor Operator">·</a> <a id="12355" href="SystemT.html#12246" class="Bound">n</a> <a id="12357" href="SystemT.html#3662" class="InductiveConstructor Operator">·</a> <a id="12359" class="Symbol">(</a><a id="12360" href="SystemT.html#3419" class="InductiveConstructor">rec</a> <a id="12364" href="SystemT.html#3662" class="InductiveConstructor Operator">·</a> <a id="12366" href="SystemT.html#12200" class="Bound">z</a> <a id="12368" href="SystemT.html#3662" class="InductiveConstructor Operator">·</a> <a id="12370" href="SystemT.html#12218" class="Bound">s</a> <a id="12372" href="SystemT.html#3662" class="InductiveConstructor Operator">·</a> <a id="12374" href="SystemT.html#12246" class="Bound">n</a><a id="12375" class="Symbol">)</a>

  <a id="_==_.β-ƛ"></a><a id="12380" href="SystemT.html#12380" class="InductiveConstructor">β-ƛ</a> <a id="12384" class="Symbol">:</a> <a id="12386" class="Symbol">∀</a> <a id="12388" class="Symbol">{</a><a id="12389" href="SystemT.html#12389" class="Bound">Γ</a> <a id="12391" class="Symbol">:</a> <a id="12393" href="SystemT.html#1272" class="Datatype">Γ</a><a id="12394" class="Symbol">}</a> <a id="12396" class="Symbol">{</a><a id="12397" href="SystemT.html#12397" class="Bound">S</a> <a id="12399" href="SystemT.html#12399" class="Bound">T</a> <a id="12401" class="Symbol">:</a> <a id="12403" href="SystemT.html#561" class="Datatype">Type</a><a id="12407" class="Symbol">}</a>
          <a id="12419" class="Symbol">{</a><a id="12420" href="SystemT.html#12420" class="Bound">t</a> <a id="12422" class="Symbol">:</a> <a id="12424" href="SystemT.html#12389" class="Bound">Γ</a> <a id="12426" href="SystemT.html#1296" class="InductiveConstructor Operator">,</a> <a id="12428" href="SystemT.html#12397" class="Bound">S</a> <a id="12430" href="SystemT.html#3345" class="Datatype Operator">⊢</a> <a id="12432" href="SystemT.html#12399" class="Bound">T</a><a id="12433" class="Symbol">}</a>
          <a id="12445" class="Symbol">{</a><a id="12446" href="SystemT.html#12446" class="Bound">s</a> <a id="12448" class="Symbol">:</a> <a id="12450" href="SystemT.html#12389" class="Bound">Γ</a> <a id="12452" href="SystemT.html#3345" class="Datatype Operator">⊢</a> <a id="12454" href="SystemT.html#12397" class="Bound">S</a><a id="12455" class="Symbol">}</a>
          <a id="12467" class="Comment">----------------------</a>
        <a id="12498" class="Symbol">→</a> <a id="12500" class="Symbol">(</a><a id="12501" href="SystemT.html#3588" class="InductiveConstructor Operator">ƛ</a> <a id="12503" href="SystemT.html#12420" class="Bound">t</a><a id="12504" class="Symbol">)</a> <a id="12506" href="SystemT.html#3662" class="InductiveConstructor Operator">·</a> <a id="12508" href="SystemT.html#12446" class="Bound">s</a> <a id="12510" href="SystemT.html#11908" class="Datatype Operator">==</a> <a id="12513" href="SystemT.html#12420" class="Bound">t</a> <a id="12515" href="SystemT.html#11243" class="Function Operator">[</a> <a id="12517" href="SystemT.html#12446" class="Bound">s</a> <a id="12519" href="SystemT.html#11243" class="Function Operator">/x]</a>

  <a id="12526" class="Comment">-- Function extensionality, i.e. Γ ⊢ t = Γ ⊢ λx. t x : S ⇒ T</a>
  <a id="_==_.η"></a><a id="12589" href="SystemT.html#12589" class="InductiveConstructor">η</a> <a id="12591" class="Symbol">:</a> <a id="12593" class="Symbol">∀</a> <a id="12595" class="Symbol">{</a><a id="12596" href="SystemT.html#12596" class="Bound">Γ</a> <a id="12598" class="Symbol">:</a> <a id="12600" href="SystemT.html#1272" class="Datatype">Γ</a><a id="12601" class="Symbol">}</a> <a id="12603" class="Symbol">{</a><a id="12604" href="SystemT.html#12604" class="Bound">S</a> <a id="12606" href="SystemT.html#12606" class="Bound">T</a> <a id="12608" class="Symbol">:</a> <a id="12610" href="SystemT.html#561" class="Datatype">Type</a><a id="12614" class="Symbol">}</a>
        <a id="12624" class="Symbol">{</a><a id="12625" href="SystemT.html#12625" class="Bound">t</a> <a id="12627" class="Symbol">:</a> <a id="12629" href="SystemT.html#12596" class="Bound">Γ</a> <a id="12631" href="SystemT.html#3345" class="Datatype Operator">⊢</a> <a id="12633" href="SystemT.html#12604" class="Bound">S</a> <a id="12635" href="SystemT.html#593" class="InductiveConstructor Operator">⇒</a> <a id="12637" href="SystemT.html#12606" class="Bound">T</a><a id="12638" class="Symbol">}</a>
        <a id="12648" class="Comment">----------------------</a>
      <a id="12677" class="Symbol">→</a> <a id="12679" href="SystemT.html#12625" class="Bound">t</a> <a id="12681" href="SystemT.html#11908" class="Datatype Operator">==</a> <a id="12684" href="SystemT.html#3588" class="InductiveConstructor Operator">ƛ</a> <a id="12686" class="Symbol">(</a><a id="12687" href="SystemT.html#12604" class="Bound">S</a> <a id="12689" href="SystemT.html#10919" class="Function Operator">↑⊢</a> <a id="12692" href="SystemT.html#12625" class="Bound">t</a><a id="12693" class="Symbol">)</a> <a id="12695" href="SystemT.html#3662" class="InductiveConstructor Operator">·</a> <a id="12697" href="SystemT.html#3528" class="InductiveConstructor Operator">`</a> <a id="12699" href="SystemT.html#2712" class="InductiveConstructor">`Z</a>

  <a id="12705" class="Comment">-- Compatibility rules</a>
  <a id="12730" class="Comment">--</a>
  <a id="12735" class="Comment">-- Note that we do not need a rule for constants and variables as</a>
  <a id="12803" class="Comment">-- is given in the thesis as we are using an intrinsically typed</a>
  <a id="12870" class="Comment">-- representation, so refl catches all of these cases</a>
  <a id="_==_.abs-compatible"></a><a id="12926" href="SystemT.html#12926" class="InductiveConstructor">abs-compatible</a> <a id="12941" class="Symbol">:</a> <a id="12943" class="Symbol">∀</a> <a id="12945" class="Symbol">{</a><a id="12946" href="SystemT.html#12946" class="Bound">Γ</a> <a id="12948" class="Symbol">:</a> <a id="12950" href="SystemT.html#1272" class="Datatype">Γ</a><a id="12951" class="Symbol">}</a> <a id="12953" class="Symbol">{</a><a id="12954" href="SystemT.html#12954" class="Bound">S</a> <a id="12956" href="SystemT.html#12956" class="Bound">T</a> <a id="12958" class="Symbol">:</a> <a id="12960" href="SystemT.html#561" class="Datatype">Type</a><a id="12964" class="Symbol">}</a> <a id="12966" class="Symbol">{</a><a id="12967" href="SystemT.html#12967" class="Bound">t</a> <a id="12969" href="SystemT.html#12969" class="Bound">t′</a> <a id="12972" class="Symbol">:</a> <a id="12974" href="SystemT.html#12946" class="Bound">Γ</a> <a id="12976" href="SystemT.html#1296" class="InductiveConstructor Operator">,</a> <a id="12978" href="SystemT.html#12954" class="Bound">S</a> <a id="12980" href="SystemT.html#3345" class="Datatype Operator">⊢</a> <a id="12982" href="SystemT.html#12956" class="Bound">T</a><a id="12983" class="Symbol">}</a>
                   <a id="13004" class="Symbol">→</a> <a id="13006" href="SystemT.html#12967" class="Bound">t</a> <a id="13008" href="SystemT.html#11908" class="Datatype Operator">==</a> <a id="13011" href="SystemT.html#12969" class="Bound">t′</a>
                     <a id="13035" class="Comment">-----------</a>
                   <a id="13066" class="Symbol">→</a> <a id="13068" href="SystemT.html#3588" class="InductiveConstructor Operator">ƛ</a> <a id="13070" href="SystemT.html#12967" class="Bound">t</a> <a id="13072" href="SystemT.html#11908" class="Datatype Operator">==</a> <a id="13075" href="SystemT.html#3588" class="InductiveConstructor Operator">ƛ</a> <a id="13077" href="SystemT.html#12969" class="Bound">t′</a>

  <a id="_==_.app-compatible"></a><a id="13083" href="SystemT.html#13083" class="InductiveConstructor">app-compatible</a> <a id="13098" class="Symbol">:</a> <a id="13100" class="Symbol">∀</a> <a id="13102" class="Symbol">{</a><a id="13103" href="SystemT.html#13103" class="Bound">Γ</a> <a id="13105" class="Symbol">:</a> <a id="13107" href="SystemT.html#1272" class="Datatype">Γ</a><a id="13108" class="Symbol">}</a> <a id="13110" class="Symbol">{</a><a id="13111" href="SystemT.html#13111" class="Bound">S</a> <a id="13113" href="SystemT.html#13113" class="Bound">T</a> <a id="13115" class="Symbol">:</a> <a id="13117" href="SystemT.html#561" class="Datatype">Type</a><a id="13121" class="Symbol">}</a>
                     <a id="13144" class="Symbol">{</a><a id="13145" href="SystemT.html#13145" class="Bound">r</a> <a id="13147" href="SystemT.html#13147" class="Bound">r′</a> <a id="13150" class="Symbol">:</a> <a id="13152" href="SystemT.html#13103" class="Bound">Γ</a> <a id="13154" href="SystemT.html#3345" class="Datatype Operator">⊢</a> <a id="13156" href="SystemT.html#13111" class="Bound">S</a> <a id="13158" href="SystemT.html#593" class="InductiveConstructor Operator">⇒</a> <a id="13160" href="SystemT.html#13113" class="Bound">T</a><a id="13161" class="Symbol">}</a> <a id="13163" class="Symbol">{</a><a id="13164" href="SystemT.html#13164" class="Bound">s</a> <a id="13166" href="SystemT.html#13166" class="Bound">s′</a> <a id="13169" class="Symbol">:</a> <a id="13171" href="SystemT.html#13103" class="Bound">Γ</a> <a id="13173" href="SystemT.html#3345" class="Datatype Operator">⊢</a> <a id="13175" href="SystemT.html#13111" class="Bound">S</a><a id="13176" class="Symbol">}</a>
                   <a id="13197" class="Symbol">→</a> <a id="13199" href="SystemT.html#13145" class="Bound">r</a> <a id="13201" href="SystemT.html#11908" class="Datatype Operator">==</a> <a id="13204" href="SystemT.html#13147" class="Bound">r′</a>
                   <a id="13226" class="Symbol">→</a> <a id="13228" href="SystemT.html#13164" class="Bound">s</a> <a id="13230" href="SystemT.html#11908" class="Datatype Operator">==</a> <a id="13233" href="SystemT.html#13166" class="Bound">s′</a>
                     <a id="13257" class="Comment">----------------</a>
                   <a id="13293" class="Symbol">→</a> <a id="13295" href="SystemT.html#13145" class="Bound">r</a> <a id="13297" href="SystemT.html#3662" class="InductiveConstructor Operator">·</a> <a id="13299" href="SystemT.html#13164" class="Bound">s</a> <a id="13301" href="SystemT.html#11908" class="Datatype Operator">==</a> <a id="13304" href="SystemT.html#13147" class="Bound">r′</a> <a id="13307" href="SystemT.html#3662" class="InductiveConstructor Operator">·</a> <a id="13309" href="SystemT.html#13166" class="Bound">s′</a>

  <a id="13315" class="Comment">-- Equivalence rules</a>
  <a id="_==_.refl"></a><a id="13338" href="SystemT.html#13338" class="InductiveConstructor">refl</a> <a id="13343" class="Symbol">:</a> <a id="13345" class="Symbol">∀</a> <a id="13347" class="Symbol">{</a><a id="13348" href="SystemT.html#13348" class="Bound">Γ</a> <a id="13350" class="Symbol">:</a> <a id="13352" href="SystemT.html#1272" class="Datatype">Γ</a><a id="13353" class="Symbol">}</a> <a id="13355" class="Symbol">{</a><a id="13356" href="SystemT.html#13356" class="Bound">T</a> <a id="13358" class="Symbol">:</a> <a id="13360" href="SystemT.html#561" class="Datatype">Type</a><a id="13364" class="Symbol">}</a> <a id="13366" class="Symbol">{</a><a id="13367" href="SystemT.html#13367" class="Bound">t</a> <a id="13369" class="Symbol">:</a> <a id="13371" href="SystemT.html#13348" class="Bound">Γ</a> <a id="13373" href="SystemT.html#3345" class="Datatype Operator">⊢</a> <a id="13375" href="SystemT.html#13356" class="Bound">T</a><a id="13376" class="Symbol">}</a>
           <a id="13389" class="Comment">------</a>
         <a id="13405" class="Symbol">→</a> <a id="13407" href="SystemT.html#13367" class="Bound">t</a> <a id="13409" href="SystemT.html#11908" class="Datatype Operator">==</a> <a id="13412" href="SystemT.html#13367" class="Bound">t</a>

  <a id="_==_.sym"></a><a id="13417" href="SystemT.html#13417" class="InductiveConstructor">sym</a> <a id="13421" class="Symbol">:</a> <a id="13423" class="Symbol">∀</a> <a id="13425" class="Symbol">{</a><a id="13426" href="SystemT.html#13426" class="Bound">Γ</a> <a id="13428" class="Symbol">:</a> <a id="13430" href="SystemT.html#1272" class="Datatype">Γ</a><a id="13431" class="Symbol">}</a> <a id="13433" class="Symbol">{</a><a id="13434" href="SystemT.html#13434" class="Bound">T</a> <a id="13436" class="Symbol">:</a> <a id="13438" href="SystemT.html#561" class="Datatype">Type</a><a id="13442" class="Symbol">}</a> <a id="13444" class="Symbol">{</a><a id="13445" href="SystemT.html#13445" class="Bound">t</a> <a id="13447" href="SystemT.html#13447" class="Bound">t′</a> <a id="13450" class="Symbol">:</a> <a id="13452" href="SystemT.html#13426" class="Bound">Γ</a> <a id="13454" href="SystemT.html#3345" class="Datatype Operator">⊢</a> <a id="13456" href="SystemT.html#13434" class="Bound">T</a><a id="13457" class="Symbol">}</a>
        <a id="13467" class="Symbol">→</a> <a id="13469" href="SystemT.html#13445" class="Bound">t</a> <a id="13471" href="SystemT.html#11908" class="Datatype Operator">==</a> <a id="13474" href="SystemT.html#13447" class="Bound">t′</a>
          <a id="13487" class="Comment">-------</a>
        <a id="13503" class="Symbol">→</a> <a id="13505" href="SystemT.html#13447" class="Bound">t′</a> <a id="13508" href="SystemT.html#11908" class="Datatype Operator">==</a> <a id="13511" href="SystemT.html#13445" class="Bound">t</a>

  <a id="_==_.trans"></a><a id="13516" href="SystemT.html#13516" class="InductiveConstructor">trans</a> <a id="13522" class="Symbol">:</a> <a id="13524" class="Symbol">∀</a> <a id="13526" class="Symbol">{</a><a id="13527" href="SystemT.html#13527" class="Bound">Γ</a> <a id="13529" class="Symbol">:</a> <a id="13531" href="SystemT.html#1272" class="Datatype">Γ</a><a id="13532" class="Symbol">}</a> <a id="13534" class="Symbol">{</a><a id="13535" href="SystemT.html#13535" class="Bound">T</a> <a id="13537" class="Symbol">:</a> <a id="13539" href="SystemT.html#561" class="Datatype">Type</a><a id="13543" class="Symbol">}</a> <a id="13545" class="Symbol">{</a><a id="13546" href="SystemT.html#13546" class="Bound">t₁</a> <a id="13549" href="SystemT.html#13549" class="Bound">t₂</a> <a id="13552" href="SystemT.html#13552" class="Bound">t₃</a> <a id="13555" class="Symbol">:</a> <a id="13557" href="SystemT.html#13527" class="Bound">Γ</a> <a id="13559" href="SystemT.html#3345" class="Datatype Operator">⊢</a> <a id="13561" href="SystemT.html#13535" class="Bound">T</a><a id="13562" class="Symbol">}</a>
          <a id="13574" class="Symbol">→</a> <a id="13576" href="SystemT.html#13546" class="Bound">t₁</a> <a id="13579" href="SystemT.html#11908" class="Datatype Operator">==</a> <a id="13582" href="SystemT.html#13549" class="Bound">t₂</a>
          <a id="13595" class="Symbol">→</a> <a id="13597" href="SystemT.html#13549" class="Bound">t₂</a> <a id="13600" href="SystemT.html#11908" class="Datatype Operator">==</a> <a id="13603" href="SystemT.html#13552" class="Bound">t₃</a>
            <a id="13618" class="Comment">--------</a>
          <a id="13637" class="Symbol">→</a> <a id="13639" href="SystemT.html#13546" class="Bound">t₁</a> <a id="13642" href="SystemT.html#11908" class="Datatype Operator">==</a> <a id="13645" href="SystemT.html#13552" class="Bound">t₃</a>

<a id="13649" class="Keyword">infix</a> <a id="13655" class="Number">3</a> <a id="13657" href="SystemT.html#11908" class="Datatype Operator">_==_</a>
</pre>
For the clarity of some of our proofs, it will also be helpful to have
the ability to use equational reasoning with respect to definitional
equality.
<pre class="Agda"><a id="13825" class="Keyword">module</a> <a id="==-Reasoning"></a><a id="13832" href="SystemT.html#13832" class="Module">==-Reasoning</a> <a id="13845" class="Keyword">where</a>
  <a id="13853" class="Keyword">infix</a>  <a id="13860" class="Number">1</a> <a id="13862" href="SystemT.html#13905" class="Function Operator">begin_</a>
  <a id="13871" class="Keyword">infixr</a> <a id="13878" class="Number">2</a> <a id="13880" href="SystemT.html#14013" class="Function Operator">_==⟨_⟩_</a>
  <a id="13890" class="Keyword">infix</a>  <a id="13897" class="Number">3</a> <a id="13899" href="SystemT.html#14184" class="Function Operator">_∎</a>

  <a id="==-Reasoning.begin_"></a><a id="13905" href="SystemT.html#13905" class="Function Operator">begin_</a> <a id="13912" class="Symbol">:</a> <a id="13914" class="Symbol">∀</a> <a id="13916" class="Symbol">{</a><a id="13917" href="SystemT.html#13917" class="Bound">Γ</a> <a id="13919" class="Symbol">:</a> <a id="13921" href="SystemT.html#1272" class="Datatype">Γ</a><a id="13922" class="Symbol">}</a> <a id="13924" class="Symbol">{</a><a id="13925" href="SystemT.html#13925" class="Bound">T</a> <a id="13927" class="Symbol">:</a> <a id="13929" href="SystemT.html#561" class="Datatype">Type</a><a id="13933" class="Symbol">}</a> <a id="13935" class="Symbol">{</a><a id="13936" href="SystemT.html#13936" class="Bound">t</a> <a id="13938" href="SystemT.html#13938" class="Bound">t′</a> <a id="13941" class="Symbol">:</a> <a id="13943" href="SystemT.html#13917" class="Bound">Γ</a> <a id="13945" href="SystemT.html#3345" class="Datatype Operator">⊢</a> <a id="13947" href="SystemT.html#13925" class="Bound">T</a><a id="13948" class="Symbol">}</a>
    <a id="13954" class="Symbol">→</a> <a id="13956" href="SystemT.html#13936" class="Bound">t</a> <a id="13958" href="SystemT.html#11908" class="Datatype Operator">==</a> <a id="13961" href="SystemT.html#13938" class="Bound">t′</a>
      <a id="13970" class="Comment">---------</a>
    <a id="13984" class="Symbol">→</a> <a id="13986" href="SystemT.html#13936" class="Bound">t</a> <a id="13988" href="SystemT.html#11908" class="Datatype Operator">==</a> <a id="13991" href="SystemT.html#13938" class="Bound">t′</a>
  <a id="13996" href="SystemT.html#13905" class="Function Operator">begin</a> <a id="14002" href="SystemT.html#14002" class="Bound">pf</a> <a id="14005" class="Symbol">=</a> <a id="14007" href="SystemT.html#14002" class="Bound">pf</a>

  <a id="==-Reasoning._==⟨_⟩_"></a><a id="14013" href="SystemT.html#14013" class="Function Operator">_==⟨_⟩_</a> <a id="14021" class="Symbol">:</a> <a id="14023" class="Symbol">∀</a> <a id="14025" class="Symbol">{</a><a id="14026" href="SystemT.html#14026" class="Bound">Γ</a> <a id="14028" class="Symbol">:</a> <a id="14030" href="SystemT.html#1272" class="Datatype">Γ</a><a id="14031" class="Symbol">}</a> <a id="14033" class="Symbol">{</a><a id="14034" href="SystemT.html#14034" class="Bound">T</a> <a id="14036" class="Symbol">:</a> <a id="14038" href="SystemT.html#561" class="Datatype">Type</a><a id="14042" class="Symbol">}</a> <a id="14044" class="Symbol">{</a><a id="14045" href="SystemT.html#14045" class="Bound">t₂</a> <a id="14048" href="SystemT.html#14048" class="Bound">t₃</a> <a id="14051" class="Symbol">:</a> <a id="14053" href="SystemT.html#14026" class="Bound">Γ</a> <a id="14055" href="SystemT.html#3345" class="Datatype Operator">⊢</a> <a id="14057" href="SystemT.html#14034" class="Bound">T</a><a id="14058" class="Symbol">}</a>
    <a id="14064" class="Symbol">→</a> <a id="14066" class="Symbol">(</a><a id="14067" href="SystemT.html#14067" class="Bound">t₁</a> <a id="14070" class="Symbol">:</a> <a id="14072" href="SystemT.html#14026" class="Bound">Γ</a> <a id="14074" href="SystemT.html#3345" class="Datatype Operator">⊢</a> <a id="14076" href="SystemT.html#14034" class="Bound">T</a><a id="14077" class="Symbol">)</a>
    <a id="14083" class="Symbol">→</a> <a id="14085" href="SystemT.html#14067" class="Bound">t₁</a> <a id="14088" href="SystemT.html#11908" class="Datatype Operator">==</a> <a id="14091" href="SystemT.html#14045" class="Bound">t₂</a>
    <a id="14098" class="Symbol">→</a> <a id="14100" href="SystemT.html#14045" class="Bound">t₂</a> <a id="14103" href="SystemT.html#11908" class="Datatype Operator">==</a> <a id="14106" href="SystemT.html#14048" class="Bound">t₃</a>
      <a id="14115" class="Comment">-----</a>
    <a id="14125" class="Symbol">→</a> <a id="14127" href="SystemT.html#14067" class="Bound">t₁</a> <a id="14130" href="SystemT.html#11908" class="Datatype Operator">==</a> <a id="14133" href="SystemT.html#14048" class="Bound">t₃</a>
  <a id="14138" href="SystemT.html#14138" class="Bound">t₁</a> <a id="14141" href="SystemT.html#14013" class="Function Operator">==⟨</a> <a id="14145" href="SystemT.html#14145" class="Bound">t₁≡t₂</a> <a id="14151" href="SystemT.html#14013" class="Function Operator">⟩</a> <a id="14153" href="SystemT.html#14153" class="Bound">t₂≡t₃</a>  <a id="14160" class="Symbol">=</a>  <a id="14163" href="SystemT.html#13516" class="InductiveConstructor">trans</a> <a id="14169" href="SystemT.html#14145" class="Bound">t₁≡t₂</a> <a id="14175" href="SystemT.html#14153" class="Bound">t₂≡t₃</a>

  <a id="==-Reasoning._∎"></a><a id="14184" href="SystemT.html#14184" class="Function Operator">_∎</a> <a id="14187" class="Symbol">:</a> <a id="14189" class="Symbol">∀</a> <a id="14191" class="Symbol">{</a><a id="14192" href="SystemT.html#14192" class="Bound">Γ</a> <a id="14194" class="Symbol">:</a> <a id="14196" href="SystemT.html#1272" class="Datatype">Γ</a><a id="14197" class="Symbol">}</a> <a id="14199" class="Symbol">{</a><a id="14200" href="SystemT.html#14200" class="Bound">T</a> <a id="14202" class="Symbol">:</a> <a id="14204" href="SystemT.html#561" class="Datatype">Type</a><a id="14208" class="Symbol">}</a> <a id="14210" class="Symbol">→</a> <a id="14212" class="Symbol">(</a><a id="14213" href="SystemT.html#14213" class="Bound">t</a> <a id="14215" class="Symbol">:</a> <a id="14217" href="SystemT.html#14192" class="Bound">Γ</a> <a id="14219" href="SystemT.html#3345" class="Datatype Operator">⊢</a> <a id="14221" href="SystemT.html#14200" class="Bound">T</a><a id="14222" class="Symbol">)</a>
      <a id="14230" class="Comment">-----</a>
    <a id="14240" class="Symbol">→</a> <a id="14242" href="SystemT.html#14213" class="Bound">t</a> <a id="14244" href="SystemT.html#11908" class="Datatype Operator">==</a> <a id="14247" href="SystemT.html#14213" class="Bound">t</a>
  <a id="14251" href="SystemT.html#14251" class="Bound">t</a> <a id="14253" href="SystemT.html#14184" class="Function Operator">∎</a>  <a id="14256" class="Symbol">=</a>  <a id="14259" href="SystemT.html#13338" class="InductiveConstructor">refl</a>

<a id="14265" class="Keyword">open</a> <a id="14270" href="SystemT.html#13832" class="Module">==-Reasoning</a> <a id="14283" class="Keyword">public</a>
</pre>
<p>Now, we are ready to start defining the algorithm for Normalization
by Evaluation in <a href="./NbE.lagda.md">NbE</a>.</p>
</body>
</html>
